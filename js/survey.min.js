var Survey;!function(t){var e=function(){function t(t,e){void 0===e&&(e=null),this.text=e,this.value=t}return t.setData=function(e,r){e.length=0;for(var n=0;n<r.length;n++){var i=r[n],s=new t(null);"undefined"!=typeof i.value?(s.text=i.text,s.value=i.value):s.value=i,e.push(s)}},t.getData=function(t){for(var e=new Array,r=0;r<t.length;r++){var n=t[r];e.push(n.hasText?{value:n.value,text:n.text}:n.value)}return e},t.prototype.getType=function(){return"itemvalue"},Object.defineProperty(t.prototype,"value",{get:function(){return this.itemValue},set:function(e){if(this.itemValue=e,this.itemValue){var r=this.itemValue.toString(),n=r.indexOf(t.Separator);n>-1&&(this.itemValue=r.slice(0,n),this.text=r.slice(n+1))}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasText",{get:function(){return this.itemText?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.hasText?this.itemText:this.value?this.value.toString():null},set:function(t){this.itemText=t},enumerable:!0,configurable:!0}),t.Separator="|",t}();t.ItemValue=e;var r=function(){function t(){this.isKO="undefined"!=typeof ko}return t.prototype.getType=function(){throw new Error("This method is abstract")},t}();t.Base=r;var n=function(){function t(){}return t.prototype.getText=function(){throw new Error("This method is abstract")},t}();t.SurveyError=n;var i=function(){function t(){}return Object.defineProperty(t.prototype,"isEmpty",{get:function(){return null==this.callbacks||0==this.callbacks.length},enumerable:!0,configurable:!0}),t.prototype.fire=function(t,e){if(null!=this.callbacks)for(var r=0;r<this.callbacks.length;r++){this.callbacks[r](t,e)}},t.prototype.add=function(t){null==this.callbacks&&(this.callbacks=new Array),this.callbacks.push(t)},t.prototype.remove=function(t){if(null!=this.callbacks){var e=this.callbacks.indexOf(t,0);void 0!=e&&this.callbacks.splice(e,1)}},t}();t.Event=i}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(){t.call(this)}return __extends(e,t),e.prototype.getText=function(){return"You should answer the question."},e}(t.SurveyError);t.AnswerRequiredError=e;var r=function(t){function e(){t.call(this)}return __extends(e,t),e.prototype.getText=function(){return"The value should be a numeric."},e}(t.SurveyError);t.RequreNumericError=r;var n=function(t){function e(e){t.call(this),this.text=e}return __extends(e,t),e.prototype.getText=function(){return this.text},e}(t.SurveyError);t.CustomError=n}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(){function t(t){this.name=t,this.className=null,this.classNamePart=null,this.baseClassName=null,this.defaultValue=null,this.onGetValue=null}return Object.defineProperty(t.prototype,"hasToUseGetValue",{get:function(){return this.onGetValue},enumerable:!0,configurable:!0}),t.prototype.isDefaultValue=function(t){return this.defaultValue?this.defaultValue==t:!t},t.prototype.getValue=function(t){return this.onGetValue?this.onGetValue(t):null},Object.defineProperty(t.prototype,"hasToUseSetValue",{get:function(){return this.onSetValue},enumerable:!0,configurable:!0}),t.prototype.setValue=function(t,e,r){this.onSetValue&&this.onSetValue(t,e,r)},t.prototype.getObjType=function(t){return this.classNamePart?t.replace(this.classNamePart,""):t},t.prototype.getClassName=function(t){return this.classNamePart&&t.indexOf(this.classNamePart)<0?t+this.classNamePart:t},t}();t.JsonObjectProperty=e;var r=function(){function t(t,r,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.name=t,this.creator=n,this.parentName=i,this.properties=null,this.requiredProperties=null,this.properties=new Array;for(var s=0;s<r.length;s++){var o=this.getPropertyName(r[s]);this.properties.push(new e(o))}}return t.prototype.find=function(t){for(var e=0;e<this.properties.length;e++)if(this.properties[e].name==t)return this.properties[e];return null},t.prototype.getPropertyName=function(e){return 0==e.length||e[0]!=t.requiredSymbol?e:(e=e.slice(1),this.requiredProperties||(this.requiredProperties=new Array),this.requiredProperties.push(e),e)},t.requiredSymbol="!",t}(),n=function(){function t(){this.classes={},this.childrenClasses={},this.classProperties={},this.classRequiredProperties={}}return t.prototype.addClass=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var s=new r(t,e,n,i);if(this.classes[t]=s,i){var o=this.childrenClasses[i];o||(this.childrenClasses[i]=[]),this.childrenClasses[i].push(s)}return s},t.prototype.setPropertyValues=function(t,e,r,n,i,s){void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=null);var o=this.findProperty(t,e);o&&(o.className=r,o.defaultValue=n,o.onGetValue=i,o.onSetValue=s)},t.prototype.setPropertyClassInfo=function(t,e,r,n){void 0===n&&(n=null);var i=this.findProperty(t,e);i&&(i.baseClassName=r,i.classNamePart=n)},t.prototype.getProperties=function(t){var e=this.classProperties[t];return e||(e=new Array,this.fillProperties(t,e),this.classProperties[t]=e),e},t.prototype.createClass=function(t){var e=this.findClass(t);return e?e.creator():null},t.prototype.getChildrenClasses=function(t,e){void 0===e&&(e=!1);var r=[];return this.fillChildrenClasses(t,e,r),r},t.prototype.getRequiredProperties=function(t){var e=this.classRequiredProperties[t];return e||(e=new Array,this.fillRequiredProperties(t,e),this.classRequiredProperties[t]=e),e},t.prototype.fillChildrenClasses=function(t,e,r){var n=this.childrenClasses[t];if(n)for(var i=0;i<n.length;i++)(!e||n[i].creator)&&r.push(n[i]),this.fillChildrenClasses(n[i].name,e,r)},t.prototype.findClass=function(t){return this.classes[t]},t.prototype.findProperty=function(t,e){var r=this.findClass(t);return r?r.find(e):null},t.prototype.fillProperties=function(t,e){var r=this.findClass(t);if(r){r.parentName&&this.fillProperties(r.parentName,e);for(var n=0;n<r.properties.length;n++)this.addProperty(r.properties[n],e,e.length)}},t.prototype.addProperty=function(t,e,r){for(var n=-1,i=0;r>i;i++)if(e[i].name==t.name){n=i;break}0>n?e.push(t):e[n]=t},t.prototype.fillRequiredProperties=function(t,e){var r=this.findClass(t);r&&(r.requiredProperties&&Array.prototype.push.apply(e,r.requiredProperties),r.parentName&&this.fillRequiredProperties(r.parentName,e))},t}();t.JsonMetadata=n;var i=function(){function t(t,e){this.type=t,this.message=e}return t}();t.JsonError=i;var s=function(t){function e(e,r){t.call(this,"unknownproperty","The property '"+e+"' in class '"+r+"' is unknown."),this.propertyName=e,this.className=r;var n=h.metaData.getProperties(r);if(n){this.description="The list of available properties are: ";for(var i=0;i<n.length;i++)i>0&&(this.description+=", "),this.description+=n[i].name;this.description+="."}}return __extends(e,t),e}(i);t.JsonUnknownPropertyError=s;var o=function(t){function e(e,r,n){t.call(this,r,n),this.baseClassName=e,this.type=r,this.message=n,this.description="The following types are available: ";for(var i=h.metaData.getChildrenClasses(e,!0),s=0;s<i.length;s++)s>0&&(this.description+=", "),this.description+="'"+i[s].name+"'";this.description+="."}return __extends(e,t),e}(i);t.JsonMissingTypeErrorBase=o;var a=function(t){function e(e,r){t.call(this,r,"missingtypeproperty","The property type is missing in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=r}return __extends(e,t),e}(o);t.JsonMissingTypeError=a;var u=function(t){function e(e,r){t.call(this,r,"incorrecttypeproperty","The property type is incorrect in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=r}return __extends(e,t),e}(o);t.JsonIncorrectTypeError=u;var l=function(t){function e(e,r){t.call(this,"requiredproperty","The property '"+e+"' is required in class '"+r+"'."),this.propertyName=e,this.className=r}return __extends(e,t),e}(i);t.JsonRequiredPropertyError=l;var h=function(){function t(){this.errors=new Array}return Object.defineProperty(t,"metaData",{get:function(){return t.metaDataValue},enumerable:!0,configurable:!0}),t.prototype.toJsonObject=function(t){return this.toJsonObjectCore(t,null)},t.prototype.toObject=function(e,r){if(e){var n=null;if(r.getType&&(n=t.metaData.getProperties(r.getType())),n)for(var i in e)if(i!=t.typePropertyName){var o=this.findProperty(n,i);o?this.valueToObj(e[i],r,i,o):this.errors.push(new s(i.toString(),r.getType()))}}},t.prototype.toJsonObjectCore=function(e,r){if(!e.getType)return e;var n={};null==r||r.className||(n[t.typePropertyName]=r.getObjType(e.getType()));for(var i=t.metaData.getProperties(e.getType()),s=0;s<i.length;s++)this.valueToJson(e,n,i[s]);return n},t.prototype.valueToJson=function(t,e,r){var n=null;if(n=r.hasToUseGetValue?r.getValue(t):t[r.name],!r.isDefaultValue(n)){if(this.isValueArray(n)){for(var i=[],s=0;s<n.length;s++)i.push(this.toJsonObjectCore(n[s],r));n=i.length>0?i:null}else n=this.toJsonObjectCore(n,r);r.isDefaultValue(n)||(e[r.name]=n)}},t.prototype.valueToObj=function(t,e,r,n){if(null!=n&&n.hasToUseSetValue)return void n.setValue(e,t,this);if(this.isValueArray(t))return void this.valueToArray(t,e,r,n);var i=this.createNewObj(t,n);i.newObj&&(this.toObject(t,i.newObj),t=i.newObj),i.error||(e[r]=t)},t.prototype.isValueArray=function(t){return t.constructor.toString().indexOf("Array")>-1},t.prototype.createNewObj=function(e,r){var n={newObj:null,error:null},i=e[t.typePropertyName];return!i&&null!=r&&r.className&&(i=r.className),i=r.getClassName(i),n.newObj=i?t.metaData.createClass(i):null,n.error=this.checkNewObjectOnErrors(n.newObj,e,r,i),n},t.prototype.checkNewObjectOnErrors=function(e,r,n,i){var s=null;if(e){var o=t.metaData.getRequiredProperties(i);if(o)for(var h=0;h<o.length;h++)if(!r[o[h]]){s=new l(o[h],i);break}}else n.baseClassName&&(s=i?new u(n.name,n.baseClassName):new a(n.name,n.baseClassName));return s&&this.errors.push(s),s},t.prototype.valueToArray=function(t,e,r,n){this.isValueArray(e[r])||(e[r]=[]);for(var i=0;i<t.length;i++){var s=this.createNewObj(t[i],n);s.newObj?(e[r].push(s.newObj),this.toObject(t[i],s.newObj)):s.error||e[r].push(t[i])}},t.prototype.findProperty=function(t,e){if(!t)return null;for(var r=0;r<t.length;r++)if(t[r].name==e)return t[r];return null},t.typePropertyName="type",t.metaDataValue=new n,t}();t.JsonObject=h}(Survey||(Survey={}));var Survey;!function(t){var e=function(){function t(){this.creatorHash={}}return t.prototype.registerQuestion=function(t,e){this.creatorHash[t]=e},t.prototype.createQuestion=function(t,e){var r=this.creatorHash[t];return null==r?null:r(e)},t.Instance=new t,t}();t.QuestionFactory=e}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(){function t(t,e){void 0===e&&(e=null),this.value=t,this.error=e}return t}();t.ValidatorResult=e;var r=function(t){function e(){t.call(this),this.text=null}return __extends(e,t),e.prototype.getErrorText=function(t){return this.text?this.text:this.getDefaultErrorText(t)},e.prototype.getDefaultErrorText=function(t){return""},e.prototype.validate=function(t,e){return void 0===e&&(e=null),null},e}(t.Base);t.SurveyValidator=r;var n=function(){function t(){}return t.prototype.run=function(t){for(var e=0;e<t.validators.length;e++){var r=t.validators[e].validate(t.value,t.getValidatorTitle());if(null!=r){if(r.error)return r.error;r.value&&(t.value=r.value)}}return null},t}();t.ValidatorRunner=n;var i=function(r){function n(t,e){void 0===t&&(t=null),void 0===e&&(e=null),r.call(this),this.minValue=t,this.maxValue=e}return __extends(n,r),n.prototype.getType=function(){return"numericvalidator"},n.prototype.validate=function(r,n){if(void 0===n&&(n=null),!r||!this.isNumber(r))return new e(null,new t.RequreNumericError);var i=new e(parseFloat(r));return this.minValue&&this.minValue>i.value?(i.error=new t.CustomError(this.getErrorText(n)),i):this.maxValue&&this.maxValue<i.value?(i.error=new t.CustomError(this.getErrorText(n)),i):"number"==typeof r?null:i},n.prototype.getDefaultErrorText=function(t){var e=t?t:"value",r="The '"+e+"' should be ";return this.minValue&&(r+="equal or more than "+this.minValue),this.maxValue&&(this.minValue&&(r+=" and "),r+=" equal or less than "+this.maxValue),r},n.prototype.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},n}(r);t.NumericValidator=i;var s=function(r){function n(t){void 0===t&&(t=0),r.call(this),this.minLength=t}return __extends(n,r),n.prototype.getType=function(){return"textvalidator"},n.prototype.validate=function(r,n){return void 0===n&&(n=null),this.minLength<=0?void 0:r.length<this.minLength?new e(null,new t.CustomError(this.getErrorText(n))):null},n.prototype.getDefaultErrorText=function(t){return"Please enter at least "+this.minLength+" symblos."},n}(r);t.TextValidator=s;var o=function(r){function n(t,e){void 0===t&&(t=null),void 0===e&&(e=null),r.call(this),this.minCount=t,this.maxCount=e}return __extends(n,r),n.prototype.getType=function(){return"answercountvalidator"},n.prototype.validate=function(r,n){if(void 0===n&&(n=null),null==r||r.constructor!=Array)return null;var i=r.length;return this.minCount&&i<this.minCount?new e(null,new t.CustomError(this.getErrorText("Please select at least "+this.minCount+" variants."))):this.maxCount&&i>this.maxCount?new e(null,new t.CustomError(this.getErrorText("Please select not more than "+this.maxCount+" variants."))):null},n.prototype.getDefaultErrorText=function(t){return t},n}(r);t.AnswerCountValidator=o,t.JsonObject.metaData.addClass("surveyvalidator",["text"]),t.JsonObject.metaData.addClass("numericvalidator",["minValue","maxValue"],function(){return new i},"surveyvalidator"),t.JsonObject.metaData.addClass("textvalidator",["minLength"],function(){return new s},"surveyvalidator"),t.JsonObject.metaData.addClass("answercountvalidator",["minCount","maxCount"],function(){return new o},"surveyvalidator")}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(e){function r(t){if(e.call(this),this.name=t,this.titleValue=null,this.isRequiredValue=!1,this.hasCommentValue=!1,this.hasOtherValue=!1,this.visibleValue=!0,this.visibleIndexValue=-1,this.errors=[],this.validators=new Array,this.width="100%",this.isValueChangedInSurvey=!1,this.isKO){this.koValue=this.createkoValue(),this.koComment=ko.observable(this.comment),this.koErrors=ko.observableArray(this.errors),this.dummyObservable=ko.observable(0);var r=this;this.koVisible=ko.computed(function(){return r.dummyObservable(),r.visibleValue}),this.koNo=ko.computed(function(){return r.dummyObservable(),r.visibleIndexValue+1}),this.koValue.subscribe(function(t){r.setNewValue(t)}),this.koComment.subscribe(function(t){r.setNewComment(t)})}}return __extends(r,e),r.prototype.createkoValue=function(){return ko.observable(this.value)},r.prototype.setkoValue=function(t){this.koValue(t)},Object.defineProperty(r.prototype,"title",{get:function(){return this.titleValue?this.titleValue:this.name},set:function(t){this.titleValue=t},enumerable:!0,configurable:!0}),r.prototype.supportComment=function(){return!1},r.prototype.supportOther=function(){return!1},Object.defineProperty(r.prototype,"isRequired",{get:function(){return this.isRequiredValue},set:function(t){this.isRequiredValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visible",{get:function(){return this.visibleValue},set:function(t){t!=this.visible&&(this.visibleValue=t,this.isKO&&this.dummyObservable(this.dummyObservable()+1),this.data&&this.data.onQuestionVisibilityChanged(this.name,this.visible))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visibleIndex",{get:function(){return this.visibleIndexValue},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hasComment",{get:function(){return this.hasCommentValue},set:function(t){this.supportComment()&&(this.hasCommentValue=t,this.hasComment&&(this.hasOther=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hasOther",{get:function(){return this.hasOtherValue},set:function(t){this.supportOther()&&(this.hasOtherValue=t,this.hasOther&&(this.hasComment=!1))},enumerable:!0,configurable:!0}),r.prototype.setData=function(t){this.data=t,this.onSurveyValueChanged(this.value)},Object.defineProperty(r.prototype,"value",{get:function(){return null!=this.data?this.data.getValue(this.name):this.questionValue},set:function(t){this.setNewValue(t),this.isKO&&this.setkoValue(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"comment",{get:function(){return null!=this.data?this.data.getComment(this.name):""},set:function(t){this.setNewComment(t),this.isKO&&this.koComment(this.comment)},enumerable:!0,configurable:!0}),r.prototype.isEmpty=function(){return null==this.value},r.prototype.hasErrors=function(){return this.checkForErrors(),this.errors.length>0},r.prototype.checkForErrors=function(){if(this.errors=[],this.onCheckForErrors(this.errors),0==this.errors.length){var t=this.runValidators();t&&this.errors.push(t)}if(this.data&&0==this.errors.length){var t=this.data.validateQuestion(this.name);t&&this.errors.push(t)}this.isKO&&this.koErrors(this.errors)},r.prototype.onCheckForErrors=function(e){this.isRequired&&this.isEmpty()&&this.errors.push(new t.AnswerRequiredError)},r.prototype.runValidators=function(){return(new t.ValidatorRunner).run(this)},r.prototype.setNewValue=function(t){this.isValueChangedInSurvey||(null!=this.data&&this.data.setValue(this.name,t),this.questionValue=t,this.onValueChanged())},r.prototype.onValueChanged=function(){},r.prototype.setNewComment=function(t){null!=this.data&&this.data.setComment(this.name,t)},r.prototype.onSurveyValueChanged=function(t){this.isValueChangedInSurvey=!0,this.value=t,this.isValueChangedInSurvey=!1},r.prototype.setVisibleIndex=function(t){this.visibleIndexValue!=t&&(this.visibleIndexValue=t,this.isKO&&this.dummyObservable(this.dummyObservable()+1))},r.prototype.getValidatorTitle=function(){return null},r}(t.Base);t.Question=e,t.JsonObject.metaData.addClass("question",["!name","title","isRequired","hasComment","hasOther","visible","validators","width"]),t.JsonObject.metaData.setPropertyValues("question","visible",null,!0),t.JsonObject.metaData.setPropertyValues("question","title",null,null,function(t){return t.titleValue}),t.JsonObject.metaData.setPropertyValues("question","width",null,"100%"),t.JsonObject.metaData.setPropertyClassInfo("question","validators","surveyvalidator","validator")}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(e){function r(t){void 0===t&&(t=""),e.call(this),this.name=t,this.questions=new Array,this.data=null,this.visible=!0,this.title="";var r=this;this.questions.push=function(t){return null!=r.data&&t.setData(r.data),Array.prototype.push.call(this,t)}}return __extends(r,e),r.prototype.getType=function(){return"page"},Object.defineProperty(r.prototype,"isVisible",{get:function(){if(!this.visible)return!1;for(var t=0;t<this.questions.length;t++)if(this.questions[t].visible)return!0;return!1},enumerable:!0,configurable:!0}),r.prototype.addQuestion=function(t){null!=t&&this.questions.push(t)},r.prototype.addNewQuestion=function(e,r){var n=t.QuestionFactory.Instance.createQuestion(e,r);return this.addQuestion(n),n},r.prototype.hasErrors=function(){for(var t=!1,e=0;e<this.questions.length;e++)this.questions[e].visible&&this.questions[e].hasErrors()&&(t=!0);return t},r.prototype.addQuestionsToList=function(t,e){if(void 0===e&&(e=!1),!e||this.visible)for(var r=0;r<this.questions.length;r++)(!e||this.questions[r].visible)&&t.push(this.questions[r])},r}(t.Base);t.Page=e,t.JsonObject.metaData.addClass("page",["name","questions","visible","title"],function(){return new e}),t.JsonObject.metaData.setPropertyValues("page","visible",null,!0),t.JsonObject.metaData.setPropertyClassInfo("page","questions","question")}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(e){function r(n){if(e.call(this,n),this.otherItem=new t.ItemValue("other",r.otherItemText),this.choicesValues=new Array,this.otherErrorText=null,this.choicesOrderValue="none",this.isKO){var i=this;this.koOtherVisible=ko.computed(function(){return i.koValue(),i.isOtherSelected()})}}return __extends(r,e),r.prototype.isOtherSelected=function(){return this.value==this.otherItem.value},Object.defineProperty(r.prototype,"choices",{get:function(){return this.choicesValues},set:function(e){t.ItemValue.setData(this.choicesValues,e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"choicesOrder",{get:function(){return this.choicesOrderValue},set:function(t){t!=this.choicesOrderValue&&(this.choicesOrderValue=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"otherText",{get:function(){return this.otherItem.text},set:function(t){this.otherItem.text=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visibleChoices",{get:function(){if(!this.hasOther&&"none"==this.choicesOrder)return this.choices;var t=this.sortVisibleChoices(this.choices.slice());return t.push(this.otherItem),t},enumerable:!0,configurable:!0}),r.prototype.supportComment=function(){return!0},r.prototype.supportOther=function(){return!0},r.prototype.onCheckForErrors=function(r){if(e.prototype.onCheckForErrors.call(this,r),this.isOtherSelected()&&!this.comment){var n=this.otherErrorText;n||(n="Please enter the others value."),r.push(new t.CustomError(n))}},r.prototype.sortVisibleChoices=function(t){var e=this.choicesOrder.toLowerCase();return"asc"==e?this.sortArray(t,1):"desc"==e?this.sortArray(t,-1):"random"==e?this.randomizeArray(t):t},r.prototype.sortArray=function(t,e){return t.sort(function(t,r){return t.text<r.text?-1*e:t.text>r.text?1*e:0})},r.prototype.randomizeArray=function(t){for(var e=t.length-1;e>0;e--){var r=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[r],t[r]=n}return t},r.otherItemText="Other (describe)",r}(t.Question);t.QuestionSelectBase=e;var r=function(t){function e(e){if(t.call(this,e),this.name=e,this.colCountValue=1,this.isKO){var r=this;this.koClass=ko.computed(function(){return r.dummyObservable(),"dxsv_qcbc"+r.colCount})}}return __extends(e,t),Object.defineProperty(e.prototype,"colCount",{get:function(){return this.colCountValue},set:function(t){0>t||t>4||(this.colCountValue=t,this.isKO&&this.dummyObservable(this.dummyObservable()+1))},enumerable:!0,configurable:!0}),e.prototype.koAfterRender=function(t,e){var r=t[0];"#text"==r.nodeName&&(r.data=""),r=t[t.length-1],"#text"==r.nodeName&&(r.data="")},e}(e);t.QuestionCheckboxBase=r,t.JsonObject.metaData.addClass("selectbase",["!choices","choicesOrder","otherText","otherErrorText"],null,"question"),t.JsonObject.metaData.setPropertyValues("selectbase","choices",null,null,function(e){return t.ItemValue.getData(e.choices)},function(e,r){t.ItemValue.setData(e.choices,r)}),t.JsonObject.metaData.setPropertyValues("selectbase","choicesOrder",null,"none"),t.JsonObject.metaData.setPropertyValues("selectbase","otherText",null,e.otherItemText),t.JsonObject.metaData.addClass("checkboxbase",["colCount"],null,"selectbase"),t.JsonObject.metaData.setPropertyValues("checkboxbase","colCount",null,1)}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(e){t.call(this,e),this.name=e}return __extends(e,t),e.prototype.createkoValue=function(){return this.value?ko.observableArray(this.value):ko.observableArray()},e.prototype.setkoValue=function(t){this.koValue(t?[].concat(t):[])},e.prototype.isOtherSelected=function(){return this.value?this.value.indexOf(this.otherItem.value)>=0:!1},e.prototype.getType=function(){return"checkbox"},e}(t.QuestionCheckboxBase);t.QuestionCheckbox=e,t.JsonObject.metaData.addClass("checkbox",[],function(){return new e("")},"checkboxbase"),t.QuestionFactory.Instance.registerQuestion("checkbox",function(t){return new e(t)})}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(e){t.call(this,e),this.name=e,this.rows=4,this.cols=50}return __extends(e,t),e.prototype.getType=function(){return"comment"},e.prototype.isEmpty=function(){return t.prototype.isEmpty.call(this)||""==this.value},e}(t.Question);t.QuestionComment=e,t.JsonObject.metaData.addClass("comment",["cols","rows"],function(){return new e("")},"question"),t.JsonObject.metaData.setPropertyValues("comment","cols",null,50),t.JsonObject.metaData.setPropertyValues("comment","rows",null,4),t.QuestionFactory.Instance.registerQuestion("comment",function(t){return new e(t)})}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(e){t.call(this,e),this.name=e}return __extends(e,t),e.prototype.getType=function(){return"dropdown"},e}(t.QuestionSelectBase);t.QuestionDropdown=e,t.JsonObject.metaData.addClass("dropdown",[],function(){return new e("")},"selectbase"),t.QuestionFactory.Instance.registerQuestion("dropdown",function(t){return new e(t)})}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(e,r,n,i,s){if(t.call(this),this.name=e,this.text=r,this.fullName=n,this.data=i,this.rowValue=s,this.isKO){this.koValue=ko.observable(this.rowValue);var o=this;this.koValue.subscribe(function(t){o.value=t})}}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.rowValue},set:function(t){this.rowValue=t,this.data&&this.data.onMatrixRowChanged(this)},enumerable:!0,configurable:!0}),e}(t.Base);t.MatrixRow=e;var r=function(r){function n(t){r.call(this,t),this.name=t,this.columnsValue=[],this.rowsValue=[]}return __extends(n,r),n.prototype.getType=function(){return"matrix"},Object.defineProperty(n.prototype,"hasRows",{get:function(){return this.rowsValue.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columns",{get:function(){return this.columnsValue},set:function(e){t.ItemValue.setData(this.columnsValue,e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rows",{get:function(){return this.rowsValue},set:function(e){t.ItemValue.setData(this.rowsValue,e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visibleRows",{get:function(){var t=new Array,r=this.value;r||(r={});for(var n=0;n<this.rows.length;n++)this.rows[n].value&&t.push(new e(this.rows[n].value,this.rows[n].text,this.name+"_"+this.rows[n].value.toString(),this,r[this.rows[n].value]));return 0==t.length&&t.push(new e(null,"",this.name,this,r)),t},enumerable:!0,configurable:!0}),n.prototype.onMatrixRowChanged=function(t){this.hasRows?(this.value||(this.value={}),this.value[t.name]=t.value):this.value=t.value},n}(t.Question);t.QuestionMatrix=r,t.JsonObject.metaData.addClass("matrix",["columns","rows"],function(){return new r("")},"question"),t.JsonObject.metaData.setPropertyValues("matrix","columns",null,null,function(e){return t.ItemValue.getData(e.columns)},function(e,r){t.ItemValue.setData(e.columns,r)}),t.JsonObject.metaData.setPropertyValues("matrix","rows",null,null,function(e){return t.ItemValue.getData(e.rows)},function(e,r){t.ItemValue.setData(e.rows,r)}),t.QuestionFactory.Instance.registerQuestion("matrix",function(t){return new r(t)})}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(e,r){if(void 0===e&&(e=null),void 0===r&&(r=null),t.call(this),this.name=e,this.isKOValueUpdating=!1,this.validators=new Array,this.title=r,this.isKO){this.koValue=ko.observable(this.value);var n=this;this.koValue.subscribe(function(t){n.isKOValueUpdating||(n.value=t)})}}return __extends(e,t),e.prototype.getType=function(){return"multipletextitem"},e.prototype.setData=function(t){this.data=t},Object.defineProperty(e.prototype,"title",{get:function(){return this.titleValue?this.titleValue:this.name},set:function(t){this.titleValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.data?this.data.getMultipleTextValue(this.name):null},set:function(t){null!=this.data&&this.data.setMultipleTextValue(this.name,t)},enumerable:!0,configurable:!0}),e.prototype.onValueChanged=function(t){this.isKO&&(this.isKOValueUpdating=!0,this.koValue(t),this.isKOValueUpdating=!1)},e.prototype.getValidatorTitle=function(){return this.title},e}(t.Base);t.MultipleTextItem=e;var r=function(e){function r(t){e.call(this,t),this.name=t,this.itemSize=25,this.items=new Array,this.isMultipleItemValueChanging=!1;var r=this;this.items.push=function(t){return t.setData(r),Array.prototype.push.call(this,t)}}return __extends(r,e),r.prototype.getType=function(){return"multipletext"},r.prototype.onValueChanged=function(){e.prototype.onValueChanged.call(this),this.onItemValueChanged()},r.prototype.setkoValue=function(t){e.prototype.setkoValue.call(this,t),this.onItemValueChanged()},r.prototype.onItemValueChanged=function(){if(!this.isMultipleItemValueChanging)for(var t=0;t<this.items.length;t++){var e=null;this.value&&this.items[t].name in this.value&&(e=this.value[this.items[t].name]),this.items[t].onValueChanged(e)}},r.prototype.runValidators=function(){var r=e.prototype.runValidators.call(this);if(null!=r)return r;for(var n=0;n<this.items.length;n++)if(r=(new t.ValidatorRunner).run(this.items[n]),null!=r)return r;return null},r.prototype.getMultipleTextValue=function(t){return this.value?this.value[t]:null},r.prototype.setMultipleTextValue=function(t,e){this.isMultipleItemValueChanging=!0,this.value||(this.value={}),this.value[t]=e,this.isMultipleItemValueChanging=!1},r}(t.Question);t.QuestionMultipleText=r,t.JsonObject.metaData.addClass("multipletextitem",["name","title","validators"],function(){return new e("")}),t.JsonObject.metaData.setPropertyClassInfo("multipletextitem","validators","surveyvalidator","validator"),t.JsonObject.metaData.setPropertyValues("multipletextitem","title",null,null,function(t){return t.titleValue}),t.JsonObject.metaData.addClass("multipletext",["!items","itemSize"],function(){return new r("")},"question"),t.JsonObject.metaData.setPropertyValues("multipletext","items","multipletextitem"),t.JsonObject.metaData.setPropertyValues("multipletext","itemSize",null,25),t.QuestionFactory.Instance.registerQuestion("multipletext",function(t){return new r(t)})}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(e){
t.call(this,e),this.name=e}return __extends(e,t),e.prototype.getType=function(){return"radiogroup"},e}(t.QuestionCheckboxBase);t.QuestionRadiogroup=e,t.JsonObject.metaData.addClass("radiogroup",[],function(){return new e("")},"checkboxbase"),t.QuestionFactory.Instance.registerQuestion("radiogroup",function(t){return new e(t)})}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(e){function r(t){if(e.call(this,t),this.name=t,this.rates=[],this.mininumRateDescription=null,this.maximumRateDescription=null,this.isKO){var r=this;this.koVisibleRateValues=ko.computed(function(){return r.visibleRateValues})}}return __extends(r,e),Object.defineProperty(r.prototype,"rateValues",{get:function(){return this.rates},set:function(e){t.ItemValue.setData(this.rates,e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visibleRateValues",{get:function(){return this.rateValues.length>0?this.rateValues:r.defaultRateValues},enumerable:!0,configurable:!0}),r.prototype.getType=function(){return"rating"},r.prototype.supportComment=function(){return!0},r.prototype.supportOther=function(){return!0},r.defaultRateValues=[],r}(t.Question);t.QuestionRating=e,t.ItemValue.setData(e.defaultRateValues,[1,2,3,4,5]),t.JsonObject.metaData.addClass("rating",["rateValues","mininumRateDescription","maximumRateDescription"],function(){return new e("")},"question"),t.JsonObject.metaData.setPropertyValues("rating","rateValues",null,null,function(e){return t.ItemValue.getData(e.rateValues)},function(e,r){t.ItemValue.setData(e.rateValues,r)}),t.QuestionFactory.Instance.registerQuestion("rating",function(t){return new e(t)})}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(e){t.call(this,e),this.name=e,this.size=25}return __extends(e,t),e.prototype.getType=function(){return"text"},e.prototype.isEmpty=function(){return t.prototype.isEmpty.call(this)||""==this.value},e}(t.Question);t.QuestionText=e,t.JsonObject.metaData.addClass("text",["size"],function(){return new e("")},"question"),t.JsonObject.metaData.setPropertyValues("text","size",null,25),t.QuestionFactory.Instance.registerQuestion("text",function(t){return new e(t)})}(Survey||(Survey={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(t){function e(){t.call(this),this.opValue="equal"}return __extends(e,t),Object.defineProperty(e,"operators",{get:function(){return null!=e.operatorsValue?e.operatorsValue:(e.operatorsValue={empty:function(t,e){return!t},notempty:function(t,e){return!!t},equal:function(t,e){return t==e},notequal:function(t,e){return t!=e},greater:function(t,e){return t>e},less:function(t,e){return e>t},greaterorequal:function(t,e){return t>=e},lessorequal:function(t,e){return e>=t}},e.operatorsValue)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"operator",{get:function(){return this.opValue},set:function(t){t&&(t=t.toLowerCase(),e.operators[t]&&(this.opValue=t))},enumerable:!0,configurable:!0}),e.prototype.check=function(t){e.operators[this.operator](t,this.value)?this.onSuccess():this.onFailure()},e.prototype.onSuccess=function(){},e.prototype.onFailure=function(){},e.operatorsValue=null,e}(t.Base);t.Trigger=e;var r=function(t){function e(){t.call(this),this.pages=[],this.questions=[],this.owner=null}return __extends(e,t),e.prototype.setOwner=function(t){this.owner=t},e.prototype.onSuccess=function(){this.onTrigger(this.onItemSuccess)},e.prototype.onFailure=function(){this.onTrigger(this.onItemFailure)},e.prototype.onTrigger=function(t){if(this.owner)for(var e=this.owner.getObjects(this.pages,this.questions),r=0;r<e.length;r++)t(e[r])},e.prototype.onItemSuccess=function(t){},e.prototype.onItemFailure=function(t){},e}(e);t.SurveyTrigger=r;var n=function(t){function e(){t.call(this)}return __extends(e,t),e.prototype.getType=function(){return"visibletrigger"},e.prototype.onItemSuccess=function(t){t.visible=!0},e.prototype.onItemFailure=function(t){t.visible=!1},e}(r);t.SurveyTriggerVisible=n,t.JsonObject.metaData.addClass("trigger",["operator","!value"]),t.JsonObject.metaData.addClass("surveytrigger",["!name","pages","questions"],null,"trigger"),t.JsonObject.metaData.addClass("visibletrigger",[],function(){return new n},"surveytrigger")}(Survey||(Survey={}));var template;!function(t){var e;!function(t){t.html='<script type="text/html" id="survey-comment">  <input data-bind="value:$data.question.koComment, visible:$data.visible" /></script><div class="sv_main">    <h3 data-bind="visible: title.length > 0, text: title"></h3>    <div data-bind="template: { name: \'survey-page\', data: koCurrentPage }"></div>    <p />    <div class="sv_nav">        <input type="button" value="Previous" data-bind="click: prevPage, visible: !koIsFirstPage()" />  <input type="button" value="Next" data-bind="click: nextPage, visible: !koIsLastPage()" />  <input type="button" value="Submit" data-bind="click: completeLastPage, visible: koIsLastPage()" />    </div></div><script type="text/html" id="survey-page">    <h3 data-bind="visible: title.length > 0, text: title"></h3>    <!-- ko template: { name: \'survey-question\', foreach: questions, as: \'question\' } -->    <!-- /ko --></script><script type="text/html" id="survey-question-checkbox">    <!-- ko foreach: { data: question.visibleChoices, as: \'item\', afterRender: question.koAfterRender}  -->    <div data-bind="css: question.koClass">        <div class="sv_q_checkbox">            <label>                <input type="checkbox"                       data-bind="value: item.value, checked: question.koValue" />                <span data-bind="text: item.text"></span>            </label>            <div data-bind="if:$index() == (question.visibleChoices.length-1), visible: question.hasOther">                <div data-bind="template: { name: \'survey-comment\', data: {\'question\': question, \'visible\': question.koOtherVisible } }"></div>            </div>        </div>    </div>    <!-- /ko --></script><script type="text/html" id="survey-question-comment">    <textarea type="text" data-bind="attr: {cols: question.cols, rows: question.rows}, value:question.koValue" /></script><script type="text/html" id="survey-question-dropdown">    <select data-bind="options: question.visibleChoices, optionsText: \'text\', optionsValue: \'value\', value: question.koValue, optionsCaption: \'Choose...\'"></select>    <div data-bind="visible: question.hasOther">        <div data-bind="template: { name: \'survey-comment\', data: {\'question\': question, \'visible\': question.koOtherVisible } }"></div>    </div></script><script type="text/html" id="survey-question-matrix">    <table class="sv_q_matrix">        <thead>            <tr>                <th data-bind="visible: question.hasRows"></th>                <!-- ko foreach: question.columns -->                <th data-bind="text:$data.text"></th>                <!-- /ko -->            </tr>        </thead>        <tbody>            <!-- ko foreach: { data: question.visibleRows, as: \'row\' } -->            <tr>                <td data-bind="visible: question.hasRows, text:row.text"></td>                <!-- ko foreach: question.columns -->                <td>                    <input type="radio" data-bind="attr: {name: row.fullName, value: $data.value}, checked: row.koValue"/>                </td>                <!-- /ko -->            </tr>            <!-- /ko -->        </tbody>    </table></script><script type="text/html" id="survey-question-multipletext">    <table data-bind="foreach: { data:  question.items, as: \'item\' }">        <tr>            <td data-bind="text: item.title"></td>            <td><input type="text" data-bind="attr: {size: question.itemSize}, value: item.koValue" /></td>        </tr>    </table></script><script type="text/html" id="survey-question-radiogroup">    <!-- ko foreach: { data: question.visibleChoices, as: \'item\', afterRender: question.koAfterRender}  -->    <div data-bind="css: question.koClass">        <div class="sv_q_radiogroup">            <label>                <input type="radio"                       data-bind="name: question.name, attr: {value: item.value}, checked: question.koValue" />                <span data-bind="text: item.text"></span>            </label>            <div data-bind="if:$index() == (question.visibleChoices.length-1), visible: question.hasOther">                <div data-bind="template: { name: \'survey-comment\', data: {\'question\': question, \'visible\': question.koOtherVisible } }"></div>            </div>        </div>     </div>    <!-- /ko --></script><script type="text/html" id="survey-question-rating">    <table class="sv_q_rating">        <thead>            <tr>                <th></th>                <!-- ko foreach: question.koVisibleRateValues -->                <th data-bind="text:$data.text"></th>                <!-- /ko -->                <th></th>            </tr>        </thead>        <tbody>            <tr>                <td data-bind="text:question.mininumRateDescription"></td>                <!-- ko foreach: question.koVisibleRateValues -->                <td>                    <input type="radio" data-bind="attr: {name: question.name, value: $data.value}, checked: question.koValue" />                </td>                <!-- /ko -->                <td data-bind="text:question.maximumRateDescription"></td>            </tr>        </tbody>    </table>    <div data-bind="visible: question.hasOther">        <div data-bind="template: { name: \'survey-comment\', data: {\'question\': question } }"></div>    </div></script><script type="text/html" id="survey-question-text">    <input type="text" data-bind="attr: {size: question.size}, value:question.koValue"/></script><script type="text/html" id="survey-question">    <div class="sv_q" data-bind="visible: question.koVisible">        <div style="color:red" data-bind="foreach: koErrors">            <div data-bind="text:$data.getText()"></div>        </div>        <h4 class="sv_q_h" data-bind="text: question.koNo() + \'. \' +  (question.isRequired ? \'* \' : \'\') + question.title"></h4>        <!-- ko template: { name: \'survey-question-\' + question.getType(), data: question } -->        <!-- /ko -->        <div data-bind="visible: question.hasComment">            Other (please describe)            <div data-bind="template: { name: \'survey-comment\', data: {\'question\': question, \'visible\': true } }"></div>        </div>    </div></script>'}(e=t.ko||(t.ko={}))}(template||(template={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r},Survey;!function(t){var e=function(e){function r(r,n){void 0===r&&(r=null),void 0===n&&(n=null),e.call(this),this.serviceUrl="http://dxsurvey.azurewebsites.net/api/Survey",this.surveyId=null,this.surveyPostId=null,this.commentPrefix="-Comment",this.title="",this.pages=new Array,this.triggers=new Array,this.currentPageValue=null,this.valuesHash={},this.onComplete=new t.Event,this.onValueChanged=new t.Event,this.onVisibleChanged=new t.Event,this.onValidateQuestion=new t.Event,this.onSendResult=new t.Event,this.onGetResult=new t.Event,this.jsonErrors=null;var i=this;this.pages.push=function(t){return t.data=i,Array.prototype.push.call(this,t)},this.triggers.push=function(t){return t.setOwner(i),Array.prototype.push.call(this,t)},ko&&(this.dummyObservable=ko.observable(0),this.koCurrentPage=ko.computed(function(){return i.dummyObservable(),i.currentPage}),this.koIsFirstPage=ko.computed(function(){return i.dummyObservable(),i.isFirstPage}),this.koIsLastPage=ko.computed(function(){return i.dummyObservable(),i.isLastPage})),r&&(this.setJsonObject(r),this.surveyId&&this.loadSurveyFromService(this.surveyId,n)),this.render(n)}return __extends(r,e),r.prototype.getType=function(){return"survey"},Object.defineProperty(r.prototype,"data",{get:function(){var t={};for(var e in this.valuesHash)t[e]=this.valuesHash[e];return t},set:function(t){if(this.valuesHash={},t)for(var e in t)this.valuesHash[e]=t[e],this.checkTriggers(e,t[e]);this.notifyAllQuestionsOnValueChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"comments",{get:function(){var t={};for(var e in this.valuesHash)"function"==typeof e.endsWith&&e.endsWith(this.commentPrefix)&&(t[e]=this.valuesHash[e]);return t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visiblePages",{get:function(){for(var t=new Array,e=0;e<this.pages.length;e++)this.pages[e].isVisible&&t.push(this.pages[e]);return t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isEmpty",{get:function(){return 0==this.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"PageCount",{get:function(){return this.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visiblePageCount",{get:function(){return this.visiblePages.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentPage",{get:function(){var t=this.visiblePages;return null!=this.currentPageValue&&t.indexOf(this.currentPageValue)<0&&(this.currentPage=null),null==this.currentPageValue&&t.length>0&&(this.currentPage=t[0]),this.currentPageValue},set:function(t){var e=this.visiblePages;null!=t&&e.indexOf(t)<0||t!=this.currentPageValue&&(this.currentPageValue=t,this.updateKoCurrentPage())},enumerable:!0,configurable:!0}),r.prototype.updateKoCurrentPage=function(){this.isKO&&this.dummyObservable(this.dummyObservable()+1)},r.prototype.nextPage=function(){if(this.isLastPage)return!1;if(this.isCurrentPageHasErrors)return!1;var t=this.visiblePages,e=t.indexOf(this.currentPage);return this.currentPage=t[e+1],!0},Object.defineProperty(r.prototype,"isCurrentPageHasErrors",{get:function(){return null==this.currentPage?!0:this.currentPage.hasErrors()},enumerable:!0,configurable:!0}),r.prototype.prevPage=function(){if(this.isFirstPage)return!1;var t=this.visiblePages,e=t.indexOf(this.currentPage);this.currentPage=t[e-1]},r.prototype.completeLastPage=function(){return this.isCurrentPageHasErrors?!1:(this.onComplete.fire(this,null),this.surveyPostId&&this.sendResult(),!0)},Object.defineProperty(r.prototype,"isFirstPage",{get:function(){return null==this.currentPage?!0:0==this.visiblePages.indexOf(this.currentPage)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isLastPage",{get:function(){if(null==this.currentPage)return!0;var t=this.visiblePages;return t.indexOf(this.currentPage)==t.length-1},enumerable:!0,configurable:!0}),r.prototype.getPage=function(t){return this.pages[t]},r.prototype.addPage=function(t){null!=t&&this.pages.push(t)},r.prototype.addNewPage=function(e){var r=new t.Page(e);return this.addPage(r),r},r.prototype.getQuestionByName=function(t){for(var e=this.getAllQuestions(),r=0;r<e.length;r++)if(e[r].name==t)return e[r];return null},r.prototype.getQuestionsByNames=function(t){var e=[];if(!t)return e;for(var r=0;r<t.length;r++)if(t[r]){var n=this.getQuestionByName(t[r]);n&&e.push(n)}return e},r.prototype.getPageByName=function(t){for(var e=0;e<this.pages.length;e++)if(this.pages[e].name==t)return this.pages[e];return null},r.prototype.getPagesByNames=function(t){var e=[];if(!t)return e;for(var r=0;r<t.length;r++)if(t[r]){var n=this.getPageByName(t[r]);n&&e.push(n)}return e},r.prototype.getAllQuestions=function(t){void 0===t&&(t=!1);for(var e=new Array,r=0;r<this.pages.length;r++)this.pages[r].addQuestionsToList(e,t);return e},r.prototype.notifyQuestionOnValueChanged=function(t,e){for(var r=this.getAllQuestions(),n=0;n<r.length;n++)r[n].name==t&&r[n].onSurveyValueChanged(e);this.onValueChanged.fire(this,{name:t,value:e})},r.prototype.notifyAllQuestionsOnValueChanged=function(){for(var t=this.getAllQuestions(),e=0;e<t.length;e++)t[e].onSurveyValueChanged(this.getValue(t[e].name))},r.prototype.checkTriggers=function(t,e){for(var r=0;r<this.triggers.length;r++)this.triggers[r].name==t&&this.triggers[r].check(e)},r.prototype.render=function(t){void 0===t&&(t=null);var e=this;t&&"string"==typeof t&&(t=document.getElementById(t)),t&&(this.renderedElement=t),t=this.renderedElement,t&&!this.isEmpty&&(this.onBeforeRender(),this.isKO&&(t.innerHTML=template.ko.html,e.applyBinding()))},r.prototype.sendResult=function(t){void 0===t&&(t=null),t&&(this.surveyPostId=t);var e=new XMLHttpRequest;e.open("POST",this.serviceUrl),e.setRequestHeader("Content-Type","application/json; charset=utf-8");var r=JSON.stringify({postId:this.surveyPostId,surveyResult:JSON.stringify(this.data)});e.setRequestHeader("Content-Length",r.length.toString());var n=this;e.onload=function(){n.onSendResult.fire(n,{success:200==e.status,response:e.response})},e.send(r)},r.prototype.getResult=function(t,e){var r=new XMLHttpRequest,n="resultId="+t+"&name="+e;r.open("GET",this.serviceUrl+"/GetResult?"+n),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var i=this;r.onload=function(){var t=null,e=null;if(200==r.status){t=JSON.parse(r.response),e=[];for(var n in t.QuestionResult){var s={name:n,value:t.QuestionResult[n]};e.push(s)}}i.onGetResult.fire(i,{success:200==r.status,data:t,dataList:e,response:r.response})},r.send()},r.prototype.loadSurveyFromService=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t&&(this.surveyId=t);var r=new XMLHttpRequest;r.open("GET",this.serviceUrl+"/GetJson?surveyId="+this.surveyId),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var n=this;r.onload=function(){if(200==r.status){var t=JSON.parse(r.response);t&&(n.setJsonObject(t),n.render(e))}},r.send()},r.prototype.onBeforeRender=function(){this.updateVisibleIndexes()},r.prototype.applyBinding=function(){this.isKO&&null!=this.renderedElement&&(this.updateKoCurrentPage(),ko.cleanNode(this.renderedElement),ko.applyBindings(this,this.renderedElement))},r.prototype.updateVisibleIndexes=function(){for(var t=0,e=this.getAllQuestions(!0),r=0;r<e.length;r++)e[r].setVisibleIndex(t++)},r.prototype.setJsonObject=function(e){if(e){this.jsonErrors=null;var r=new t.JsonObject;r.toObject(e,this),r.errors.length>0&&(this.jsonErrors=r.errors)}},r.prototype.getValue=function(t){return t&&0!=t.length?this.valuesHash[t]:null},r.prototype.setValue=function(t,e){""==e||null==e?delete this.valuesHash[t]:this.valuesHash[t]=e,this.notifyQuestionOnValueChanged(t,e),this.checkTriggers(t,e)},r.prototype.getComment=function(t){var e=this.data[t+this.commentPrefix];return null==e&&(e=""),e},r.prototype.setComment=function(t,e){t+=this.commentPrefix,""==e||null==e?delete this.valuesHash[t]:this.valuesHash[t]=e},r.prototype.onQuestionVisibilityChanged=function(t,e){this.updateVisibleIndexes(),this.onVisibleChanged.fire(this,{name:t,visible:e})},r.prototype.validateQuestion=function(e){if(this.onValidateQuestion.isEmpty)return null;var r={name:e,value:this.getValue(e),error:null};return this.onValidateQuestion.fire(this,r),r.error?new t.CustomError(r.error):null},r.prototype.getObjects=function(t,e){var r=[];return Array.prototype.push.apply(r,this.getPagesByNames(t)),Array.prototype.push.apply(r,this.getQuestionsByNames(e)),r},r}(t.Base);t.Survey=e,t.JsonObject.metaData.addClass("survey",["title","pages","questions","triggers","surveyId","surveyPostId"]),t.JsonObject.metaData.setPropertyValues("survey","pages","page"),t.JsonObject.metaData.setPropertyValues("survey","questions","",null,function(t){return null},function(t,e,r){var n=t.addNewPage("");r.toObject({questions:e},n)}),t.JsonObject.metaData.setPropertyClassInfo("survey","triggers","surveytrigger","trigger"),t.JsonObject.metaData.setPropertyClassInfo("survey","questions","question")}(Survey||(Survey={}));