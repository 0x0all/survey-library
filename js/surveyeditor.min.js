var SurveyEditor;!function(t){var e=function(){function t(t,e,s){void 0===s&&(s=null),this.property=t,this.editorType=e,this.name=this.property.name,this.koValue=ko.observable();var r=this;this.itemValues=null,"itemvalues"==e&&(this.itemValues=new i(function(t){r.koValue(t)})),this.koValue.subscribe(function(t){null!=r.object&&r.object[r.name]!=t&&(null==s||r.isValueUpdating||s(r,t))}),this.koText=ko.computed(function(){return r.getValueText(r.koValue())}),this.koIsDefault=ko.computed(function(){return r.property.isDefaultValue(r.koValue())})}return Object.defineProperty(t.prototype,"object",{get:function(){return this.objectValue},set:function(t){this.objectValue=t,this.updateValue()},enumerable:!0,configurable:!0}),t.prototype.updateValue=function(){this.isValueUpdating=!0,this.koValue(this.object[this.name]),this.itemValues&&(this.itemValues.value=this.koValue()),this.isValueUpdating=!1},t.prototype.getValueText=function(t){return null!=t&&Array.isArray(t)?"[ Items: "+t.length+" ]":t},t}();t.SurveyObjectProperty=e;var i=function(){function t(t){this.onValueChanged=t,this.koItems=ko.observableArray(),this.koNewValue=ko.observable(),this.koNewText=ko.observable(),this.value_=[];var e=this;e.onApplyClick=function(){e.Apply()},e.onDeleteClick=function(t){e.koItems.remove(t)},e.onAddClick=function(){e.AddItem()}}return Object.defineProperty(t.prototype,"value",{get:function(){return this.value_},set:function(t){null!=t&&Array.isArray(t)||(t=[]),this.value_=t;for(var e=[],i=0;i<t.length;i++){var s=t[i];e.push({koValue:ko.observable(s.value),koText:ko.observable(s.text)})}this.koItems(e)},enumerable:!0,configurable:!0}),t.prototype.AddItem=function(){this.koItems.push({koValue:ko.observable(this.koNewValue()),koText:ko.observable(this.koNewText())}),this.koNewValue(null),this.koNewText(null)},t.prototype.Apply=function(){this.value_=[];for(var t=0;t<this.koItems().length;t++){var e=this.koItems()[t];this.value_.push({value:e.koValue(),text:e.koText()})}this.onValueChanged&&this.onValueChanged(this.value_)},t}();t.SurveyPropertyItemValue=i}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function e(){this.onPropertyValueChanged=new Survey.Event,this.koProperties=ko.observableArray(),this.koActiveProperty=ko.observable(),this.koTitle=ko.observable(""),this.koHasObject=ko.observable(),this.koShowProperties=ko.observable()}return Object.defineProperty(e.prototype,"title",{get:function(){return this.koTitle()},set:function(t){this.koTitle(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedObject",{get:function(){return this.selectedObjectValue},set:function(t){this.selectedObjectValue!=t&&(this.koHasObject(null!=t),this.selectedObjectValue=t,this.updateProperties(),this.updatePropertiesObject())},enumerable:!0,configurable:!0}),e.prototype.getPropertyEditor=function(t){for(var e=this.koProperties(),i=0;i<e.length;i++)if(e[i].name==t)return e[i];return null},e.prototype.changeActiveProperty=function(t){this.koActiveProperty(t)},e.prototype.ObjectChanged=function(){this.updatePropertiesObject()},e.prototype.showProperties=function(){this.koShowProperties(!this.koShowProperties())},e.prototype.updateProperties=function(){var e=this;if(!this.selectedObject||!this.selectedObject.getType)return this.koProperties([]),void this.koActiveProperty(null);var i=Survey.JsonObject.metaData.getProperties(this.selectedObject.getType());i.sort(function(t,e){return t.name==e.name?0:t.name>e.name?1:-1});for(var s=[],r=this,o=function(t,i){r.onPropertyValueChanged.fire(e,{property:t.property,object:t.object,newValue:i})},n=0;n<i.length;n++)if(this.canShowProperty(i[n])){var a=this.getPropertyEditorType(i[n]),u=new t.SurveyObjectProperty(i[n],a,o);"dropdown"==a&&(u.choices=this.getPropertyEditorChoices(i[n])),s.push(u)}this.koProperties(s),this.koActiveProperty(this.getPropertyEditor("name"))},e.prototype.getPropertyEditorType=function(t){var e=t.name;return"showQuestionNumbers"==e||"choicesOrder"==e||"colCount"==e?"dropdown":"choices"==e||"columns"==e||"rows"==e||"rateValues"==e?"itemvalues":"visible"==e||0==e.indexOf("is")||0==e.indexOf("has")||0==e.indexOf("show")||"sendResultOnPageNext"==e?"boolean":"text"},e.prototype.getPropertyEditorChoices=function(t){var e=t.name;return"showQuestionNumbers"==e?["on","onPage","off"]:"choicesOrder"==e?["none","asc","desc","random"]:"colCount"==e?[1,2,3,4]:[]},e.prototype.canShowProperty=function(t){var e=t.name;return"questions"==e||"pages"==e?!1:!0},e.prototype.updatePropertiesObject=function(){for(var t=this.koProperties(),e=0;e<t.length;e++)t[e].object=this.selectedObject},e}();t.SurveyObjectEditor=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.koPages=ko.observableArray(),this.koIsValid=ko.observable(!1),this.onAddNewPageCallback=t,this.onSelectPageCallback=e;var i=this;i.selectPageClick=function(t){i.onSelectPageCallback&&i.onSelectPageCallback(t.page)}}return Object.defineProperty(t.prototype,"survey",{get:function(){return this.surveyValue},set:function(t){this.surveyValue=t,this.koIsValid(null!=this.surveyValue),this.updatePages()},enumerable:!0,configurable:!0}),t.prototype.setSelectedPage=function(t){for(var e=this.koPages(),i=0;i<e.length;i++)e[i].koSelected(e[i].page==t)},t.prototype.addNewPageClick=function(){this.onAddNewPageCallback&&this.onAddNewPageCallback()},t.prototype.removePage=function(t){var e=this.getIndexByPage(t);e>-1&&this.koPages.splice(e,1)},t.prototype.changeName=function(t){var e=this.getIndexByPage(t);e>-1&&this.koPages()[e].title(t.name)},t.prototype.getIndexByPage=function(t){for(var e=this.koPages(),i=0;i<e.length;i++)if(e[i].page==t)return i;return-1},t.prototype.updatePages=function(){if(null==this.surveyValue)return void this.koPages([]);for(var t=[],e=0;e<this.surveyValue.pages.length;e++){var i=this.surveyValue.pages[e];t.push({title:ko.observable(i.name),page:i,koSelected:ko.observable(!1)})}this.koPages(t)},t}();t.SurveyPagesEditor=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=(function(){function t(){}return t}(),function(){function e(t){this.text=t,this.errors=[],this.process()}return Object.defineProperty(e.prototype,"survey",{get:function(){return this.surveyValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isJsonCorrect",{get:function(){return this.surveyValue&&!this.surveyValue.isEmpty},enumerable:!0,configurable:!0}),e.prototype.process=function(){try{this.jsonValue=new t.SurveyJSON5(1).parse(this.text)}catch(e){this.errors.push({pos:{start:e.at,end:-1},text:e.message})}if(null!=this.jsonValue&&(this.updateJsonPositions(this.jsonValue),this.surveyValue=new Survey.Survey(this.jsonValue),null!=this.surveyValue.jsonErrors))for(var i=0;i<this.surveyValue.jsonErrors.length;i++){var e=this.surveyValue.jsonErrors[i];this.errors.push({pos:{start:e.at,end:-1},text:e.getFullDescription()})}this.surveyObjects=this.createSurveyObjects(),this.setEditorPositionByChartAt(this.surveyObjects),this.setEditorPositionByChartAt(this.errors)},e.prototype.updateJsonPositions=function(t){t.pos.self=t;for(var e in t){var i=t[e];i&&i.pos&&(t.pos[e]=i.pos,this.updateJsonPositions(i))}},e.prototype.createSurveyObjects=function(){var t=[];if(null==this.surveyValue)return t;this.isSurveyAsPage=!1;for(var e=0;e<this.surveyValue.pages.length;e++){var i=this.surveyValue.pages[e];0!=e||i.pos||(i.pos=this.surveyValue.pos,this.isSurveyAsPage=!0),t.push(i);for(var s=0;s<i.questions.length;s++)t.push(i.questions[s])}return t},e.prototype.setEditorPositionByChartAt=function(t){if(null!=t&&0!=t.length)for(var e={row:0,column:0},i=this.getAtArray(t),s=0,r=0;r<i.length;r++){var o=i[r].at;e=this.getPostionByChartAt(e,s,o);var n=i[r].obj;n.position||(n.position={}),o==n.pos.start?n.position.start=e:o==n.pos.end&&(n.position.end=e),s=o}},e.prototype.getPostionByChartAt=function(t,i,s){for(var r={row:t.row,column:t.column},o=i;s>o;)this.text.charAt(o)==e.newLineChar?(r.row++,r.column=0):r.column++,o++;return r},e.prototype.getAtArray=function(t){for(var e=[],i=0;i<t.length;i++){var s=t[i],r=s.pos;r&&(e.push({at:r.start,obj:s}),r.end>0&&e.push({at:r.end,obj:s}))}return e.sort(function(t,e){return t.at>e.at?1:t.at<e.at?-1:0})},e}());t.SurveyTextWorker=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function e(e){void 0===e&&(e=null),this.timeoutId=-1,this.questionTypes=Survey.QuestionFactory.Instance.getAllTypes(),this.koSelectedQuestionType=ko.observable(this.questionTypes[0]),this.koCanDeleteObject=ko.observable(!1);var i=this;this.koObjects=ko.observableArray(),this.koSelectedObject=ko.observable(),this.koSelectedObject.subscribe(function(t){i.selectedObjectChanged(null!=t?t.value:null)}),this.surveyObjects=new t.SurveyObjects(this.koObjects,this.koSelectedObject),this.selectedObjectEditor=new t.SurveyObjectEditor,this.selectedObjectEditor.title="Survey",this.selectedObjectEditor.koShowProperties(!0),this.selectedObjectEditor.onPropertyValueChanged.add(function(t,e){i.onPropertyValueChanged(e.property,e.object,e.newValue)}),this.pagesEditor=new t.SurveyPagesEditor(function(){i.addPage()},function(t){i.surveyObjects.selectObject(t)}),this.surveyEmbeding=new t.SurveyEmbedingWindow,this.koIsShowDesigner=ko.observable(!0),this.selectDesignerClick=function(){i.showDesigner()},this.selectEditorClick=function(){i.showJsonEditor()},this.selectQuestionTypeClick=function(t){i.koSelectedQuestionType(t)},this.runSurveyClick=function(){i.showLiveSurvey()},this.embedingSurveyClick=function(){i.showSurveyEmbeding()},this.deleteObjectClick=function(){i.deleteCurrentObject()},e&&this.render(e)}return Object.defineProperty(e.prototype,"survey",{get:function(){return this.surveyValue},enumerable:!0,configurable:!0}),e.prototype.render=function(t){void 0===t&&(t=null);var e=this;t&&"string"==typeof t&&(t=document.getElementById(t)),t&&(this.renderedElement=t),t=this.renderedElement,t&&(t.innerHTML=templateEditor.ko.html,e.applyBinding())},Object.defineProperty(e.prototype,"text",{get:function(){return null!=this.jsonEditor?this.jsonEditor.getValue():""},set:function(t){this.setTextValue(t,1)},enumerable:!0,configurable:!0}),e.prototype.getTextAndProcess=function(){var t=this.text;return this.timeoutId>0&&(clearTimeout(this.timeoutId),this.timeoutId=-1,this.processJson(t)),t},e.prototype.setText=function(t,e){this.isTextChangedFromDesigner=!0,this.text=t,this.isTextChangedFromDesigner=!1,this.jsonEditor.find(e)},e.prototype.addPage=function(){var t=this.getNewName(this.survey.pages,"page"),e=this.surveyValue.addNewPage(t);this.pagesEditor.survey=this.surveyValue,this.surveyObjects.addPage(e),null!=this.surveyjs&&this.surveyjs.focus()},e.prototype.addQuestion=function(){var t=this.survey.currentPage;if(null!=t){var e=this.getNewName(this.survey.getAllQuestions(),"question"),i=Survey.QuestionFactory.Instance.createQuestion(this.koSelectedQuestionType(),e);t.addQuestion(i),this.surveyObjects.addQuestion(t,i),this.surveyValue.render()}},e.prototype.onPropertyValueChanged=function(t,e,i){t.isDefaultValue(i);e[t.name]=i,"name"==t.name&&(this.surveyObjects.nameChanged(e),"page"==e.getType()&&this.pagesEditor.changeName(e)),this.surveyValue.render()},e.prototype.showDesigner=function(){return this.textWorker.isJsonCorrect?(this.initSurvey((new Survey.JsonObject).toJsonObject(this.textWorker.survey)),void this.koIsShowDesigner(!0)):void alert("Please correct JSON!")},e.prototype.showJsonEditor=function(){var e=(new Survey.JsonObject).toJsonObject(this.survey);this.jsonEditor.setValue((new t.SurveyJSON5).stringify(e,null,1)),this.jsonEditor.focus(),this.koIsShowDesigner(!1)},e.prototype.selectedObjectChanged=function(t){var e=!1;this.selectedObjectEditor.selectedObject=t,null!=t&&"page"==t.getType()&&(this.survey.currentPage=t,e=this.survey.pages.length>1),this.survey.selectedQuestion=null!=t&&t.koValue?t:null,e=e||null!=this.survey.selectedQuestion,null!=this.survey.selectedQuestion&&(this.survey.currentPage=this.survey.getPageByQuestion(this.survey.selectedQuestion)),this.koCanDeleteObject(e)},e.prototype.setTextValue=function(t,e){null!=this.jsonEditor&&(this.isProcessingImmediately=!0,this.jsonEditor.setValue(t,e),this.jsonEditor.renderer.updateFull(!0),this.processJson(t),this.isProcessingImmediately=!1)},e.prototype.applyBinding=function(){null!=this.renderedElement&&(ko.cleanNode(this.renderedElement),ko.applyBindings(this,this.renderedElement),this.surveyjs=document.getElementById("surveyjs"),this.jsonEditor=ace.edit("surveyjsEditor"),this.surveyjsExample=document.getElementById("surveyjsExample"),this.initSurvey((new t.SurveyJSON5).parse(e.defaultNewSurveyText)),this.surveyValue.mode="designer",this.surveyValue.render(this.surveyjs),this.initJsonEditor(),t.SurveyTextWorker.newLineChar=this.jsonEditor.session.doc.getNewLineCharacter())},e.prototype.initJsonEditor=function(){var t=this;this.jsonEditor.setTheme("ace/theme/monokai"),this.jsonEditor.session.setMode("ace/mode/json"),this.jsonEditor.setShowPrintMargin(!1),this.jsonEditor.getSession().on("change",function(){t.onJsonEditorChanged()}),this.jsonEditor.getSession().setUseWorker(!0)},e.prototype.initSurvey=function(t){this.surveyValue=new Survey.Survey(t),this.survey.mode="designer",this.survey.render(this.surveyjs),this.surveyObjects.survey=this.survey,this.pagesEditor.survey=this.survey,this.pagesEditor.setSelectedPage(this.survey.currentPage);var e=this;this.surveyValue.onSelectedQuestionChanged.add(function(t,i){e.surveyObjects.selectObject(t.selectedQuestion)}),this.surveyValue.onCurrentPageChanged.add(function(t,i){e.pagesEditor.setSelectedPage(t.currentPage)})},e.prototype.onJsonEditorChanged=function(){if(this.timeoutId>-1&&clearTimeout(this.timeoutId),this.isProcessingImmediately)this.timeoutId=-1;else{var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=-1,t.processJson(t.text)},e.updateTextTimeout)}},e.prototype.processJson=function(e){this.textWorker=new t.SurveyTextWorker(e),this.jsonEditor.getSession().setAnnotations(this.createAnnotations(e,this.textWorker.errors))},e.prototype.deleteCurrentObject=function(){var t=this.koSelectedObject().value;this.surveyObjects.removeObject(t),"page"==t.getType()?(this.survey.removePage(t),this.pagesEditor.removePage(t)):(this.survey.currentPage.removeQuestion(t),this.survey.selectedQuestion=null,this.surveyObjects.selectObject(this.survey.currentPage)),this.survey.render()},e.prototype.showLiveSurvey=function(){if(this.surveyjsExample){var e=this.getSurveyJSON();if(null!=e){var i=new Survey.Survey(e),s=this;i.onComplete.add(function(e){s.surveyjsExample.innerHTML="Survey Result: "+(new t.SurveyJSON5).stringify(i.data)}),i.render(this.surveyjsExample)}else this.surveyjsExample.innerHTML="Please correct JSON!"}},e.prototype.showSurveyEmbeding=function(){var t=this.getSurveyJSON();this.surveyEmbeding.json=t,this.surveyEmbeding.show()},e.prototype.getSurveyJSON=function(){return this.koIsShowDesigner()?(new Survey.JsonObject).toJsonObject(this.survey):this.textWorker.isJsonCorrect?(new Survey.JsonObject).toJsonObject(this.textWorker.survey):null},e.prototype.createAnnotations=function(t,e){for(var i=new Array,s=0;s<e.length;s++){var r=e[s],o={row:r.position.start.row,column:r.position.start.column,text:r.text,type:"error"};i.push(o)}return i},e.prototype.getNewName=function(t,e){for(var i={},s=0;s<t.length;s++)i[t[s].name]=!0;for(var r=1;;){if(!i[e+r.toString()])break;r++}return e+r.toString()},e.updateTextTimeout=1e3,e.defaultNewSurveyText="{ pages: [ { name: 'page1'}] }",e}();t.SurveyEditor=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function t(t){void 0===t&&(t=0),this.parseType=t}return t.prototype.parse=function(t,e,i,s){void 0===e&&(e=null),void 0===i&&(i=0),void 0===s&&(s=-1);var r;return this.text=String(t),this.at=i,this.endAt=s,this.ch=" ",r=this.value(),this.white(),this.ch&&this.error("Syntax error"),"function"==typeof e?function o(t,i){var s,r,n=t[i];if(n&&"object"==typeof n)for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r=o(n,s),void 0!==r?n[s]=r:delete n[s]);return e.call(t,i,n)}({"":r},""):r},t.prototype.error=function(t){var e=new SyntaxError;throw e.message=t,e.at=this.at,e},t.prototype.next=function(t){return void 0===t&&(t=null),t&&t!==this.ch&&this.error("Expected '"+t+"' instead of '"+this.ch+"'"),this.ch=this.chartAt(),this.at+=1,this.ch},t.prototype.peek=function(){return this.chartAt()},t.prototype.chartAt=function(){return this.endAt>-1&&this.at>=this.endAt?"":this.text.charAt(this.at)},t.prototype.identifier=function(){var t=this.ch;for("_"!==this.ch&&"$"!==this.ch&&(this.ch<"a"||this.ch>"z")&&(this.ch<"A"||this.ch>"Z")&&this.error("Bad identifier");this.next()&&("_"===this.ch||"$"===this.ch||this.ch>="a"&&this.ch<="z"||this.ch>="A"&&this.ch<="Z"||this.ch>="0"&&this.ch<="9");)t+=this.ch;return t},t.prototype.number=function(){var t,e="",i="",s=10;if(("-"===this.ch||"+"===this.ch)&&(e=this.ch,this.next(this.ch)),"I"===this.ch)return t=this.word(),("number"!=typeof t||isNaN(t))&&this.error("Unexpected word for number"),"-"===e?-t:t;if("N"===this.ch)return t=this.word(),isNaN(t)||this.error("expected word to be NaN"),t;switch("0"===this.ch&&(i+=this.ch,this.next(),"x"===this.ch||"X"===this.ch?(i+=this.ch,this.next(),s=16):this.ch>="0"&&this.ch<="9"&&this.error("Octal literal")),s){case 10:for(;this.ch>="0"&&this.ch<="9";)i+=this.ch,this.next();if("."===this.ch)for(i+=".";this.next()&&this.ch>="0"&&this.ch<="9";)i+=this.ch;if("e"===this.ch||"E"===this.ch)for(i+=this.ch,this.next(),("-"===this.ch||"+"===this.ch)&&(i+=this.ch,this.next());this.ch>="0"&&this.ch<="9";)i+=this.ch,this.next();break;case 16:for(;this.ch>="0"&&this.ch<="9"||this.ch>="A"&&this.ch<="F"||this.ch>="a"&&this.ch<="f";)i+=this.ch,this.next()}return t="-"===e?-i:+i,isFinite(t)?t:void this.error("Bad number")},t.prototype.string=function(){var e,i,s,r,o="";if('"'===this.ch||"'"===this.ch)for(s=this.ch;this.next();){if(this.ch===s)return this.next(),o;if("\\"===this.ch)if(this.next(),"u"===this.ch){for(r=0,i=0;4>i&&(e=parseInt(this.next(),16),isFinite(e));i+=1)r=16*r+e;o+=String.fromCharCode(r)}else if("\r"===this.ch)"\n"===this.peek()&&this.next();else{if("string"!=typeof t.escapee[this.ch])break;o+=t.escapee[this.ch]}else{if("\n"===this.ch)break;o+=this.ch}}this.error("Bad string")},t.prototype.inlineComment=function(){"/"!==this.ch&&this.error("Not an inline comment");do if(this.next(),"\n"===this.ch||"\r"===this.ch)return void this.next();while(this.ch)},t.prototype.blockComment=function(){"*"!==this.ch&&this.error("Not a block comment");do for(this.next();"*"===this.ch;)if(this.next("*"),"/"===this.ch)return void this.next("/");while(this.ch);this.error("Unterminated block comment")},t.prototype.comment=function(){"/"!==this.ch&&this.error("Not a comment"),this.next("/"),"/"===this.ch?this.inlineComment():"*"===this.ch?this.blockComment():this.error("Unrecognized comment")},t.prototype.white=function(){for(;this.ch;)if("/"===this.ch)this.comment();else{if(!(t.ws.indexOf(this.ch)>=0))return;this.next()}},t.prototype.word=function(){switch(this.ch){case"t":return this.next("t"),this.next("r"),this.next("u"),this.next("e"),!0;case"f":return this.next("f"),this.next("a"),this.next("l"),this.next("s"),this.next("e"),!1;case"n":return this.next("n"),this.next("u"),this.next("l"),this.next("l"),null;case"I":return this.next("I"),this.next("n"),this.next("f"),this.next("i"),this.next("n"),this.next("i"),this.next("t"),this.next("y"),1/0;case"N":return this.next("N"),this.next("a"),this.next("N"),0/0}this.error("Unexpected '"+this.ch+"'")},t.prototype.array=function(){var t=[];if("["===this.ch)for(this.next("["),this.white();this.ch;){if("]"===this.ch)return this.next("]"),t;if(","===this.ch?this.error("Missing array element"):t.push(this.value()),this.white(),","!==this.ch)return this.next("]"),t;this.next(","),this.white()}this.error("Bad array")},t.prototype.object=function(){var e,i,s=!0,r={};if(this.parseType>0&&(r[t.positionName]={start:this.at-1}),"{"===this.ch)for(this.next("{"),this.white(),i=this.at-1;this.ch;){if("}"===this.ch)return this.parseType>0&&(r[t.positionName].end=i),this.next("}"),r;if(e='"'===this.ch||"'"===this.ch?this.string():this.identifier(),this.white(),this.parseType>1&&(r[t.positionName][e]={start:i,valueStart:this.at}),this.next(":"),r[e]=this.value(),this.parseType>1&&(i=this.at-1,r[t.positionName][e].valueEnd=i,r[t.positionName][e].end=i),this.white(),","!==this.ch)return this.parseType>1&&(r[t.positionName][e].valueEnd--,r[t.positionName][e].end--),this.parseType>0&&(r[t.positionName].end=this.at-1),this.next("}"),r;this.parseType>1&&(r[t.positionName][e].valueEnd--,s||r[t.positionName][e].end--),this.next(","),this.white(),s=!1}this.error("Bad object")},t.prototype.value=function(){switch(this.white(),this.ch){case"{":return this.object();case"[":return this.array();case'"':case"'":return this.string();case"-":case"+":case".":return this.number();default:return this.ch>="0"&&this.ch<="9"?this.number():this.word()}},t.prototype.stringify=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),e&&"function"!=typeof e&&!this.isArray(e))throw new Error("Replacer must be a function or an array");this.replacer=e,this.indentStr=this.getIndent(i),this.objStack=[];var s={"":t};return void 0===t?this.getReplacedValueOrUndefined(s,"",!0):this.internalStringify(s,"",!0)},t.prototype.getIndent=function(t){if(t){if("string"==typeof t)return t;if("number"==typeof t&&t>=0)return this.makeIndent(" ",t,!0)}return""},t.prototype.getReplacedValueOrUndefined=function(t,e,i){var s=t[e];return s&&s.toJSON&&"function"==typeof s.toJSON&&(s=s.toJSON()),"function"==typeof this.replacer?this.replacer.call(t,e,s):this.replacer?i||this.isArray(t)||this.replacer.indexOf(e)>=0?s:void 0:s},t.prototype.isWordChar=function(t){return t>="a"&&"z">=t||t>="A"&&"Z">=t||t>="0"&&"9">=t||"_"===t||"$"===t},t.prototype.isWordStart=function(t){return t>="a"&&"z">=t||t>="A"&&"Z">=t||"_"===t||"$"===t},t.prototype.isWord=function(t){if("string"!=typeof t)return!1;if(!this.isWordStart(t[0]))return!1;for(var e=1,i=t.length;i>e;){if(!this.isWordChar(t[e]))return!1;e++}return!0},t.prototype.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},t.prototype.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},t.prototype.isNaN=function(t){return"number"==typeof t&&t!==t},t.prototype.checkForCircular=function(t){for(var e=0;e<this.objStack.length;e++)if(this.objStack[e]===t)throw new TypeError("Converting circular structure to JSON")},t.prototype.makeIndent=function(t,e,i){if(void 0===i&&(i=!1),!t)return"";t.length>10&&(t=t.substring(0,10));for(var s=i?"":"\n",r=0;e>r;r++)s+=t;return s},t.prototype.escapeString=function(e){return t.escapable.lastIndex=0,t.escapable.test(e)?'"'+e.replace(t.escapable,function(e){var i=t.meta[e];return"string"==typeof i?i:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},t.prototype.internalStringify=function(t,e,i){var s,r,o=this.getReplacedValueOrUndefined(t,e,i);switch(o&&!this.isDate(o)&&(o=o.valueOf()),typeof o){case"boolean":return o.toString();case"number":return isNaN(o)||!isFinite(o)?"null":o.toString();case"string":return this.escapeString(o.toString());case"object":if(null===o)return"null";if(this.isArray(o)){this.checkForCircular(o),s="[",this.objStack.push(o);for(var n=0;n<o.length;n++)r=this.internalStringify(o,n,!1),s+=this.makeIndent(this.indentStr,this.objStack.length),s+=null===r||"undefined"==typeof r?"null":r,n<o.length-1?s+=",":this.indentStr&&(s+="\n");this.objStack.pop(),s+=this.makeIndent(this.indentStr,this.objStack.length,!0)+"]"}else{this.checkForCircular(o),s="{";var a=!1;this.objStack.push(o);for(var u in o)if(o.hasOwnProperty(u)){var h=this.internalStringify(o,u,!1);if(i=!1,"undefined"!=typeof h&&null!==h){s+=this.makeIndent(this.indentStr,this.objStack.length),a=!0;var e=this.isWord(u)?u:this.escapeString(u);s+=e+":"+(this.indentStr?" ":"")+h+","}}this.objStack.pop(),s=a?s.substring(0,s.length-1)+this.makeIndent(this.indentStr,this.objStack.length)+"}":"{}"}return s;default:return void 0}},t.positionName="pos",t.escapee={"'":"'",'"':'"',"\\":"\\","/":"/","\n":"",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},t.ws=[" ","	","\r","\n","","\f"," ","\ufeff"],t.cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,t.escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,t.meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t}();t.SurveyJSON5=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function e(){var t=this;this.koShowAsWindow=ko.observable("page"),this.koShowAsWindow.subscribe(function(e){t.surveyEmbedingJava.setValue(t.getJavaText())}),this.surveyEmbedingHead=null}return Object.defineProperty(e.prototype,"json",{get:function(){return this.jsonValue},set:function(t){this.jsonValue=t},enumerable:!0,configurable:!0}),e.prototype.show=function(){if(null==this.surveyEmbedingHead){this.surveyEmbedingHead=this.createEditor("surveyEmbedingHead"),this.surveyEmbedingHead.setValue('<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.3.0/knockout-min.js" ></script>\n<script src="js/survey.min.js"></script>\n<link href="css/survey.css" type="text/css" rel="stylesheet" />');var t=this.createEditor("surveyEmbedingBody");t.setValue('< div id= "mySurveyJSName" ></div>'),this.surveyEmbedingJava=this.createEditor("surveyEmbedingJava")}this.surveyEmbedingJava.setValue(this.getJavaText())},e.prototype.createEditor=function(t){var e=ace.edit(t);return e.setTheme("ace/theme/monokai"),e.session.setMode("ace/mode/json"),e.setShowPrintMargin(!1),e.renderer.setShowGutter(!1),e.setReadOnly(!0),e},e.prototype.getJavaText=function(){var t="page"==this.koShowAsWindow(),e=t?"var survey = new Survey.Survey(\n":"var surveyWindow = new Survey.SurveyWindow(";return e+=this.getJsonText(),e+=");\n",t||(e+="surveyWindow."),e+='survey.onComplete.add(function (s) { alert("The results are:" + JSON.stringify(s.data)); });\n',t?e+='survey.render("mySurveyJSName")':(e+='surveyWindow.title = "My Survey Window Title.";\n',e+="surveyWindow.show();"),e},e.prototype.getJsonText=function(){return(new t.SurveyJSON5).stringify(this.json)},e}();t.SurveyEmbedingWindow=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function t(){}return t}();t.SurveyObjectItem=e;var i=function(){function t(t,e){this.koObjects=t,this.koSelected=e}return Object.defineProperty(t.prototype,"survey",{get:function(){return this.surveyValue},set:function(t){this.survey!=t&&(this.surveyValue=t,this.rebuild())},enumerable:!0,configurable:!0}),t.prototype.addPage=function(t){var e=this.createPage(t,this.survey.pages.length-1);this.koObjects.push(e),this.koSelected(e)},t.prototype.addQuestion=function(t,e){var i=this.getItemIndex(t);if(!(0>i)){i+=t.questions.length;var s=this.createQuestion(e);i>this.koObjects().length?this.koObjects.push(s):this.koObjects.splice(i,0,s),this.koSelected(s)}},t.prototype.selectObject=function(t){for(var e=this.koObjects(),i=0;i<e.length;i++)if(e[i].value==t)return void this.koSelected(e[i])},t.prototype.removeObject=function(t){var e=this.getItemIndex(t);if(!(0>e)){var i=1;if("page"==t.getType()){var s=t;i+=s.questions.length}this.koObjects.splice(e,i)}},t.prototype.nameChanged=function(t){var e=this.getItemIndex(t);0>e||this.koObjects()[e].text(this.getText(t))},t.prototype.rebuild=function(){var t=[];if(null==this.survey)return this.koObjects(t),void this.koSelected(null);t.push(this.createItem(this.survey,"Survey"));for(var e=0;e<this.survey.pages.length;e++){var i=this.survey.pages[e];t.push(this.createPage(i,e));for(var s=0;s<i.questions.length;s++)t.push(this.createQuestion(i.questions[s]))}this.koObjects(t),this.koSelected(this.survey)},t.prototype.createPage=function(t,e){return this.createItem(t,this.getText(t))},t.prototype.createQuestion=function(t){return this.createItem(t,this.getText(t))},t.prototype.createItem=function(t,i){var s=new e;return s.value=t,s.text=ko.observable(i),s},t.prototype.getItemIndex=function(t){for(var e=this.koObjects(),i=0;i<e.length;i++)if(e[i].value==t)return i;return-1},t.prototype.getText=function(e){var i=t.intend;return"page"!=e.getType()&&(i+=t.intend),i+e.name},t.intend="...",t}();t.SurveyObjects=i}(SurveyEditor||(SurveyEditor={}));var templateEditor;!function(t){var e;!function(t){t.html='<nav class="navbar navbar-default">    <div class="container-fluid">        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">            <ul class="nav navbar-nav">                <li class="dropdown">                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span data-bind="text: koIsShowDesigner() ? \'Survey Designer\': \'JSON Editor\'"></span> <span class="caret"></span></a>                    <ul class="dropdown-menu">                        <li><a href="#" data-bind="click:selectDesignerClick">Use Survey Designer</a></li>                        <li><a href="#" data-bind="click:selectEditorClick">Use JSON Editor</a></li>                    </ul>                </li>            </ul>            <form class="navbar-form navbar-left">                <button type="button" class="btn btn-default" data-bind="click: runSurveyClick" data-toggle="modal" data-target="#surveyExampleModal">Run Survey</button>                <button type="button" class="btn btn-default" data-bind="click: embedingSurveyClick" data-toggle="modal" data-target="#surveyEmbedingModal">Embeding Survey to Your Page</button>            </form>        </div><!-- /.navbar-collapse -->    </div><!-- /.container-fluid --></nav><div class="panel" style="width:100%">    <div id="surveyjsEditor" data-bind="visible: !koIsShowDesigner()" style="height:450px;width:100%"></div>    <div class="row" data-bind="visible: koIsShowDesigner()">        <div class="col-xs-4 col-md-3">            <div class="panel panel-default" style="width:100%">                <div class="panel-heading">                    <div class="row">                        <select style="width:80%"  data-bind="options: koObjects, optionsText: \'text\', value: koSelectedObject"></select>                        <button type="button" data-bind="enable: koCanDeleteObject, click: deleteCurrentObject" style="width:15%" class="btn btn-default"><span class="glyphicon glyphicon-remove"></span></button>                    </div>                </div>                <div data-bind="template: { name: \'objecteditor\', data: selectedObjectEditor }"></div>            </div>        </div>        <div class="col-xs-12 col-sm-6 col-md-8">            <div data-bind="template: { name: \'pageeditor\', data: pagesEditor }"></div>            <div style="overflow-y: scroll;height:450px;">                <div id="surveyjs" style="width:100%"></div>            </div>            <nav class="navbar navbar-default">                <div class="collapse navbar-collapse">                    <form class="navbar-form navbar-left">                        <button type="button" class="btn btn-default" data-bind="click: addQuestion">Add Question</button>                    </form>                    <ul class="nav navbar-nav">                        <!-- ko foreach: questionTypes -->                        <li data-bind="css: {active: $parent.koSelectedQuestionType() == $data}, click: $parent.selectQuestionTypeClick($data)"><a><span data-bind="text:$data" style="cursor: pointer"></span></a></li>                        <!-- /ko  -->                    </ul>                </div>            </nav>        </div>    </div></div><div id="surveyExampleModal" class="modal fade" role="dialog">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal">&times;</button>                <h4 class="modal-title">Running survey</h4>            </div>            <div class="modal-body">                <div id="surveyjsExample"></div>            </div>        </div>    </div></div><div id="surveyEmbedingModal" class="modal fade" role="dialog">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal">&times;</button>                <h4 class="modal-title">Embeding survey</h4>            </div>            <div class="modal-body">                <div data-bind="template: { name: \'surveyembeding\', data: surveyEmbeding }"></div>            </div>        </div>    </div></div><script type="text/html" id="objecteditor">    <table class="table" data-bind="visible:koShowProperties">        <tbody data-bind="foreach: koProperties">            <tr data-bind="click: $parent.changeActiveProperty($data), style: {background: $parent.koActiveProperty() == $data ? \'lightgray\': \'\'}">                <td data-bind="text: name" width="50%"></td>                <td width="50%">                    <span data-bind="text: koText, visible: $parent.koActiveProperty() != $data, attr: {title: koText}, style: {color: koIsDefault() ? \'gray\' : \'\'}" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden"></span>                    <div data-bind="visible: $parent.koActiveProperty() == $data">                        <!-- ko template: { name: \'propertyeditor-\' + editorType, data: $data } -->                        <!-- /ko -->                    </div>                </td>            </tr>        </tbody>    </table></script><script type="text/html" id="pageeditor">    <ul class="nav nav-tabs">        <!-- ko foreach: koPages -->        <li data-bind="css: {active: koSelected()}">             <a href="#" data-bind="click:$parent.selectPageClick">                <span data-bind="text: title"></span>            </a>        </li>        <!-- /ko  -->        <li><button type="button" class="btn btn-default" data-bind="click:addNewPageClick"><span class="glyphicon glyphicon-plus"></span></button></li>    </ul></script><script type="text/html" id="propertyeditor-boolean">    <input type="checkbox" data-bind="checked: koValue" /></script><script type="text/html" id="propertyeditor-dropdown">    <select data-bind="value: koValue, options: choices"  style="width:100%"></select></script><script type="text/html" id="propertyeditor-itemvalues">    <div class="panel" data-bind="with: itemValues" style="position:absolute; z-index:100; top:parentOffset.top;left:parentOffset.left - 100">        <table class="table">            <thead>                <tr>                    <th>Value</th>                    <th>Text</th>                    <th></th>                </tr>            </thead>            <tbody>                <!-- ko foreach: koItems -->                <tr>                    <td><input type="text" data-bind="value:koValue" style="width:100px" /></td>                    <td><input type="text" data-bind="value:koText" style="width:100px" /></td>                    <td><input type="button" data-bind="click: $parent.onDeleteClick" value="Delete" /></td>                </tr>                <!-- /ko -->                <tr>                    <td><input type="text" data-bind="value:koNewValue" style="width:100px" /></td>                    <td><input type="text" data-bind="value:koNewText" style="width:100px" /></td>                    <td><input type="button" data-bind="click: onAddClick" value="Add" /></td>                </tr>            </tbody>        </table>        <div class="panel-footer">            <input type="button" value="Apply" data-bind="click: onApplyClick" />        </div>    </div></script><script type="text/html" id="propertyeditor-text">    <input type="text" data-bind="value: koValue" style="width:100%" /></script><script type="text/html" id="surveyembeding">    <div class="panel">        <div class="panel-heading">Scripts and styles</div>        <div id="surveyEmbedingHead" style="height:70px;width:100%"></div>    </div>    <select data-bind="value:koShowAsWindow">        <option value="page">Use Survey Inside a Page</option>        <option value="window">Use Survey as a Window</option>    </select>    <div class="panel" data-bind="visible: koShowAsWindow()==\'page\'">        <div class="panel-heading">HTML Inside body</div>        <div id="surveyEmbedingBody" style="height:30px;width:100%"></div>    </div>    <div class="panel">        <div class="panel-heading">Java Script</div>        <div id="surveyEmbedingJava" style="height:300px;width:100%"></div>    </div></script>';

}(e=t.ko||(t.ko={}))}(templateEditor||(templateEditor={}));