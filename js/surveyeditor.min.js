var SurveyEditor;!function(t){var e=function(){function t(t,e,r){void 0===r&&(r=null),this.property=t,this.editorType=e,this.name=this.property.name,this.koValue=ko.observable();var o=this;this.itemValues=null,"itemvalues"==e&&(this.itemValues=new i(function(t){o.koValue(t)})),this.koValue.subscribe(function(t){null==r||o.isValueUpdating||r(o,t)}),this.koText=ko.computed(function(){return o.getValueText(o.koValue())}),this.koIsDefault=ko.computed(function(){return o.property.isDefaultValue(o.koValue())})}return Object.defineProperty(t.prototype,"object",{get:function(){return this.objectValue},set:function(t){this.objectValue=t,this.updateValue()},enumerable:!0,configurable:!0}),t.prototype.updateValue=function(){this.isValueUpdating=!0,this.koValue(this.object[this.name]),this.itemValues&&(this.itemValues.value=this.koValue()),this.isValueUpdating=!1},t.prototype.getValueText=function(t){return null!=t&&Array.isArray(t)?JSON.stringify(t):t},t}();t.SurveyObjectProperty=e;var i=function(){function t(t){this.onValueChanged=t,this.koItems=ko.observableArray(),this.koNewValue=ko.observable(),this.koNewText=ko.observable(),this.value_=[];var e=this;e.onApplyClick=function(){e.Apply()},e.onDeleteClick=function(t){e.koItems.remove(t)},e.onAddClick=function(){e.AddItem()}}return Object.defineProperty(t.prototype,"value",{get:function(){return this.value_},set:function(t){null!=t&&Array.isArray(t)||(t=[]),this.value_=t;for(var e=[],i=0;i<t.length;i++){var r=t[i];e.push({koValue:ko.observable(r.value),koText:ko.observable(r.text)})}this.koItems(e)},enumerable:!0,configurable:!0}),t.prototype.AddItem=function(){this.koItems.push({koValue:ko.observable(this.koNewValue()),koText:ko.observable(this.koNewText())}),this.koNewValue(null),this.koNewText(null)},t.prototype.Apply=function(){this.value_=[];for(var t=0;t<this.koItems().length;t++){var e=this.koItems()[t];this.value_.push({value:e.koValue(),text:e.koText()})}this.onValueChanged&&this.onValueChanged(this.value_)},t}();t.SurveyPropertyItemValue=i}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function e(){this.onPropertyValueChanged=new Survey.Event,this.koProperties=ko.observableArray(),this.koActiveProperty=ko.observable(),this.koTitle=ko.observable(""),this.koHasObject=ko.observable(),this.koShowProperties=ko.observable(),this.koShowProperties(!0)}return Object.defineProperty(e.prototype,"title",{get:function(){return this.koTitle()},set:function(t){this.koTitle(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedObject",{get:function(){return this.selectedObjectValue},set:function(t){this.selectedObjectValue!=t&&(this.koHasObject(null!=t),this.selectedObjectValue=t,this.updateProperties(),this.updatePropertiesObject())},enumerable:!0,configurable:!0}),e.prototype.getPropertyEditor=function(t){for(var e=this.koProperties(),i=0;i<e.length;i++)if(e[i].name==t)return e[i];return null},e.prototype.changeActiveProperty=function(t){this.koActiveProperty(t)},e.prototype.ObjectChanged=function(){this.updatePropertiesObject()},e.prototype.showProperties=function(){this.koShowProperties(!this.koShowProperties())},e.prototype.updateProperties=function(){var e=this;if(!this.selectedObject||!this.selectedObject.getType)return this.koProperties([]),void this.koActiveProperty(null);var i=Survey.JsonObject.metaData.getProperties(this.selectedObject.getType());i.sort(function(t,e){return t.name==e.name?0:t.name>e.name?1:-1});for(var r=[],o=this,s=function(t,i){o.onPropertyValueChanged.fire(e,{property:t.property,object:t.object,newValue:i})},n=0;n<i.length;n++)if(this.canShowProperty(i[n])){var a=this.getPropertyEditorType(i[n]),h=new t.SurveyObjectProperty(i[n],a,s);"dropdown"==a&&(h.choices=this.getPropertyEditorChoices(i[n])),r.push(h)}this.koProperties(r),this.koActiveProperty(this.getPropertyEditor("name"))},e.prototype.getPropertyEditorType=function(t){var e=t.name;return"showQuestionNumbers"==e?"dropdown":"choices"==e||"columns"==e||"rows"==e||"rateValues"==e?"itemvalues":"visible"==e||0==e.indexOf("is")||0==e.indexOf("has")||0==e.indexOf("show")?"boolean":"text"},e.prototype.getPropertyEditorChoices=function(t){var e=t.name;return"showQuestionNumbers"==e?["on","onPage","off"]:[]},e.prototype.canShowProperty=function(t){var e=t.name;return"questions"==e||"pages"==e?!1:!0},e.prototype.updatePropertiesObject=function(){for(var t=this.koProperties(),e=0;e<t.length;e++)t[e].object=this.selectedObject},e}();t.SurveyObjectEditor=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.koPages=ko.observableArray(),this.koIsValid=ko.observable(!1),this.onAddNewPageCallback=t,this.onSelectPageCallback=e;var i=this;i.selectPageClick=function(t){i.onSelectPageCallback&&i.onSelectPageCallback(t.page)}}return Object.defineProperty(t.prototype,"survey",{get:function(){return this.surveyValue},set:function(t){this.surveyValue=t,this.koIsValid(null!=this.surveyValue),this.updatePages()},enumerable:!0,configurable:!0}),t.prototype.setSelectedPage=function(t){for(var e=this.koPages(),i=0;i<e.length;i++)e[i].koSelected(e[i].page==t)},t.prototype.addNewPageClick=function(){this.onAddNewPageCallback&&this.onAddNewPageCallback()},t.prototype.updatePages=function(){if(null==this.surveyValue)return void this.koPages([]);for(var t=[],e=0;e<this.surveyValue.pages.length;e++)t.push({title:"Page "+(e+1),page:this.surveyValue.pages[e],koSelected:ko.observable(!1)});this.koPages(t)},t}();t.SurveyPagesEditor=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function t(){}return t}(),i=function(){function i(t){this.text=t,this.errors=[],this.process()}return Object.defineProperty(i.prototype,"survey",{get:function(){return this.surveyValue},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isJsonCorrect",{get:function(){return this.surveyValue&&!this.surveyValue.isEmpty},enumerable:!0,configurable:!0}),i.prototype.process=function(){try{this.jsonValue=new t.SurveyJSON5(1).parse(this.text)}catch(e){this.errors.push({pos:{start:e.at,end:-1},text:e.message})}if(null!=this.jsonValue&&(this.updateJsonPositions(this.jsonValue),this.surveyValue=new Survey.Survey(this.jsonValue),null!=this.surveyValue.jsonErrors))for(var i=0;i<this.surveyValue.jsonErrors.length;i++){var e=this.surveyValue.jsonErrors[i];this.errors.push({pos:{start:e.at,end:-1},text:e.getFullDescription()})}this.surveyObjects=this.createSurveyObjects(),this.setEditorPositionByChartAt(this.surveyObjects),this.setEditorPositionByChartAt(this.errors)},i.prototype.addPage=function(t){if(null!=this.surveyValue){var e="",i="{name: '"+t+"', questions: []}";if(0==this.surveyValue.pages.length)e="{ pages: \n ["+i+"\n]}";else if(this.isSurveyAsPage)e="{ pages: \n ["+this.text+",\n"+i+"]}";else{var r=this.surveyValue.pages[this.surveyValue.pages.length-1].pos.end;e=this.text.substr(0,r)+", \n"+i+this.text.substr(r)}this.text=e}},i.prototype.addQuestion=function(t,e){if(null!=t){var i=this.getQuestionText(e),r="",o=0;if(t.questions.length>0)o=t.questions[t.questions.length-1].pos.end,r=this.text.substr(0,o)+", \n"+i+this.text.substr(o);else{var s=t.pos.questions;if(s)o=s.end-1,r=this.text.substr(0,o)+i+this.text.substr(o);else{var n=t.pos,a=this.text.substr(n.start,n.end-n.start-1),h=""!=a.trim()?", ":"";o=n.end-1,r=this.text.substr(0,o)+h+"questions: ["+i+"]"+this.text.substr(o)}}this.text=r}},i.prototype.changeProperty=function(t,e,i,r){var o=t.pos;if(o){var s=this.getPropertyInfo(o.start,o.end,e),n=this.text;r?s.isFound&&(n=this.text.substr(0,s.start)+this.text.substr(s.end+1)):(i=this.getValueText(i),n=s.isFound?this.text.substr(0,s.valueStart)+" "+i+this.text.substr(s.end+1):this.text.substr(0,o.end-1)+", "+e+": "+i+this.text.substr(o.end-1)),this.text=n}},i.prototype.getCurrentSurveyObjects=function(t,e){var i=[];if(!this.surveyObjects)return i;for(var r=0;r<this.surveyObjects.length;r++){var o=this.surveyObjects[r].position;if(o){var s=o.start,n=o.end;(s.row<t||s.row==t&&s.column<=e)&&(n.row>t||n.row==t&&n.column>e)&&i.push(this.surveyObjects[r])}}return i},i.prototype.getPropertyInfo=function(i,r,o){var s=new e;s.isFound=!1;var n=new t.SurveyJSON5(2).parse(this.text,null,i,r);if(!n||!n[t.SurveyJSON5.positionName]||!n[t.SurveyJSON5.positionName][o])return s;var a=n[t.SurveyJSON5.positionName][o];return s.isFound=!0,s.start=a.start,s.end=a.end,s.valueStart=a.valueStart,s},i.prototype.getQuestionText=function(t){var e=(new Survey.JsonObject).toJsonObject(t);return e.type=t.getType(),this.stringify(e)},i.prototype.updateJsonPositions=function(t){t.pos.self=t;for(var e in t){var i=t[e];i&&i.pos&&(t.pos[e]=i.pos,this.updateJsonPositions(i))}},i.prototype.createSurveyObjects=function(){var t=[];if(null==this.surveyValue)return t;this.isSurveyAsPage=!1;for(var e=0;e<this.surveyValue.pages.length;e++){var i=this.surveyValue.pages[e];0!=e||i.pos||(i.pos=this.surveyValue.pos,this.isSurveyAsPage=!0),t.push(i);for(var r=0;r<i.questions.length;r++)t.push(i.questions[r])}return t},i.prototype.setEditorPositionByChartAt=function(t){if(null!=t&&0!=t.length)for(var e={row:0,column:0},i=this.getAtArray(t),r=0,o=0;o<i.length;o++){var s=i[o].at;e=this.getPostionByChartAt(e,r,s);var n=i[o].obj;n.position||(n.position={}),s==n.pos.start?n.position.start=e:s==n.pos.end&&(n.position.end=e),r=s}},i.prototype.getPostionByChartAt=function(t,e,r){for(var o={row:t.row,column:t.column},s=e;r>s;)this.text.charAt(s)==i.newLineChar?(o.row++,o.column=0):o.column++,s++;return o},i.prototype.getAtArray=function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i],o=r.pos;o&&(e.push({at:o.start,obj:r}),o.end>0&&e.push({at:o.end,obj:r}))}return e.sort(function(t,e){return t.at>e.at?1:t.at<e.at?-1:0})},i.prototype.getValueText=function(t){return this.stringify(t)},i.prototype.stringify=function(e){return(new t.SurveyJSON5).stringify(e)},i}();t.SurveyTextWorker=i}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function e(e){void 0===e&&(e=null),this.timeoutId=-1,this.koSelectedPage=ko.observable(null),this.koSelectedQuestion=ko.observable(null),this.questionTypes=Survey.QuestionFactory.Instance.getAllTypes(),this.koSelectedQuestionType=ko.observable(this.questionTypes[0]);var i=this;this.surveyEditor=new t.SurveyObjectEditor,this.surveyEditor.title="Survey Properties",this.surveyEditor.koShowProperties(!1),this.surveyEditor.onPropertyValueChanged.add(function(t,e){i.onPropertyValueChanged(e.property,e.object,e.newValue)}),this.pageEditor=new t.SurveyObjectEditor,this.pageEditor.onPropertyValueChanged.add(function(t,e){i.onPropertyValueChanged(e.property,e.object,e.newValue)}),this.questionEditor=new t.SurveyObjectEditor,this.questionEditor.onPropertyValueChanged.add(function(t,e){i.onPropertyValueChanged(e.property,e.object,e.newValue)}),this.pagesEditor=new t.SurveyPagesEditor(function(){i.addPage()},function(t){i.moveToObject(t)}),e&&this.render(e)}return Object.defineProperty(e.prototype,"survey",{get:function(){return null!=this.textWorker?this.textWorker.survey:null},enumerable:!0,configurable:!0}),e.prototype.render=function(t){void 0===t&&(t=null);var e=this;t&&"string"==typeof t&&(t=document.getElementById(t)),t&&(this.renderedElement=t),t=this.renderedElement,t&&(t.innerHTML=templateEditor.ko.html,e.applyBinding())},Object.defineProperty(e.prototype,"text",{get:function(){return null!=this.jsonEditor?this.jsonEditor.getValue():""},set:function(t){this.setTextValue(t,1)},enumerable:!0,configurable:!0}),e.prototype.getTextAndProcess=function(){var t=this.text;return this.timeoutId>0&&(clearTimeout(this.timeoutId),this.timeoutId=-1,this.processJson(t)),t},e.prototype.setText=function(t,e){this.text=t,this.jsonEditor.find(e)},e.prototype.addPage=function(){if(null!=this.textWorker&&this.textWorker.isJsonCorrect){var t=this.getNewName(this.textWorker.survey.pages,"page");this.textWorker.addPage(t),this.setText(this.textWorker.text,t)}},e.prototype.addQuestion=function(){var t=this.koSelectedPage();if(null!=t){var e=this.getNewName(this.textWorker.survey.getAllQuestions(),"question");this.textWorker.addQuestion(t,Survey.QuestionFactory.Instance.createQuestion(this.koSelectedQuestionType(),e)),this.setText(this.textWorker.text,e)}},e.prototype.onPropertyValueChanged=function(t,e,i){if(e&&e.pos){var r=t.isDefaultValue(i);r?delete e[t.name]:e[t.name]=i,this.textWorker.changeProperty(e,t.name,i,r),this.setText(this.textWorker.text,e.name)}},e.prototype.setTextValue=function(t,e){null!=this.jsonEditor&&(this.isProcessingImmediately=!0,this.jsonEditor.setValue(t,e),this.processJson(t),this.isProcessingImmediately=!1)},e.prototype.applyBinding=function(){null!=this.renderedElement&&(ko.cleanNode(this.renderedElement),ko.applyBindings(this,this.renderedElement),this.jsonEditor=ace.edit("surveyjsEditor"),this.surveyjsSelectedObj=document.getElementById("surveyjsSelectedObj"),this.surveyjsExample=document.getElementById("surveyjsExample"),this.initJsonEditor(),t.SurveyTextWorker.newLineChar=this.jsonEditor.session.doc.getNewLineCharacter())},e.prototype.initJsonEditor=function(){var t=this;this.jsonEditor.setTheme("ace/theme/monokai"),this.jsonEditor.session.setMode("ace/mode/json"),this.jsonEditor.setShowPrintMargin(!1),this.jsonEditor.getSession().on("change",function(){t.onJsonEditorChanged()}),this.jsonEditor.selection.on("changeCursor",function(){t.onJsonEditorCursorChanged()}),this.jsonEditor.getSession().setUseWorker(!0),this.text=e.defaultNewSurveyText},e.prototype.onJsonEditorChanged=function(){if(this.timeoutId>-1&&clearTimeout(this.timeoutId),this.isProcessingImmediately)this.timeoutId=-1;else{var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=-1,t.processJson(t.text)},e.updateTextTimeout)}},e.prototype.onJsonEditorCursorChanged=function(){if(null!=this.textWorker&&this.textWorker.isJsonCorrect){for(var t=this.jsonEditor.getCursorPosition(),e=this.textWorker.getCurrentSurveyObjects(t.row,t.column),i=null,r=null,o=0;o<e.length;o++)"page"==e[o].getType()?i=e[o]:r=e[o];this.koSelectedPage(i),this.koSelectedQuestion(r),this.pageEditor.selectedObject=i,this.pagesEditor.setSelectedPage(i),i&&(this.pageEditor.title="Page properties: page"+(this.textWorker.survey.pages.indexOf(i)+1)),this.questionEditor.selectedObject=r,r&&(this.questionEditor.title="Question properties: "+r.name)}},e.prototype.moveToObject=function(t){var e=t.position;e&&(this.jsonEditor.moveCursorTo(e.start.row,e.start.column),this.jsonEditor.selection.clearSelection())},e.prototype.processJson=function(e){this.textWorker=new t.SurveyTextWorker(e),this.surveyjsExample&&(this.textWorker.isJsonCorrect?this.textWorker.survey.render(this.surveyjsExample):this.surveyjsExample.innerText="Please correct the survey JSON."),this.surveyEditor.selectedObject=this.textWorker.survey,this.pagesEditor.survey=this.textWorker.survey,this.onJsonEditorCursorChanged(),this.jsonEditor.getSession().setAnnotations(this.createAnnotations(e,this.textWorker.errors))},e.prototype.createAnnotations=function(t,e){for(var i=new Array,r=0;r<e.length;r++){var o=e[r],s={row:o.position.start.row,column:o.position.start.column,text:o.text,type:"error"};i.push(s)}return i},e.prototype.getNewName=function(t,e){for(var i={},r=0;r<t.length;r++)i[t[r].name]=!0;for(var o=1;;){if(!i[e+o.toString()])break;o++}return e+o.toString()},e.updateTextTimeout=1e3,e.defaultNewSurveyText="{ pages: [ { name: 'page1', questions: [{ type: 'text', name: 'question1' }] }] }",e}();t.SurveyEditor=e}(SurveyEditor||(SurveyEditor={}));var SurveyEditor;!function(t){var e=function(){function t(t){void 0===t&&(t=0),this.parseType=t}return t.prototype.parse=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=-1);var o;return this.text=String(t),this.at=i,this.endAt=r,this.ch=" ",o=this.value(),this.white(),this.ch&&this.error("Syntax error"),"function"==typeof e?function s(t,i){var r,o,n=t[i];if(n&&"object"==typeof n)for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o=s(n,r),void 0!==o?n[r]=o:delete n[r]);return e.call(t,i,n)}({"":o},""):o},t.prototype.error=function(t){var e=new SyntaxError;throw e.message=t,e.at=this.at,e},t.prototype.next=function(t){return void 0===t&&(t=null),t&&t!==this.ch&&this.error("Expected '"+t+"' instead of '"+this.ch+"'"),this.ch=this.chartAt(),this.at+=1,this.ch},t.prototype.peek=function(){return this.chartAt()},t.prototype.chartAt=function(){return this.endAt>-1&&this.at>=this.endAt?"":this.text.charAt(this.at)},t.prototype.identifier=function(){var t=this.ch;for("_"!==this.ch&&"$"!==this.ch&&(this.ch<"a"||this.ch>"z")&&(this.ch<"A"||this.ch>"Z")&&this.error("Bad identifier");this.next()&&("_"===this.ch||"$"===this.ch||this.ch>="a"&&this.ch<="z"||this.ch>="A"&&this.ch<="Z"||this.ch>="0"&&this.ch<="9");)t+=this.ch;return t},t.prototype.number=function(){var t,e="",i="",r=10;if(("-"===this.ch||"+"===this.ch)&&(e=this.ch,this.next(this.ch)),"I"===this.ch)return t=this.word(),("number"!=typeof t||isNaN(t))&&this.error("Unexpected word for number"),"-"===e?-t:t;if("N"===this.ch)return t=this.word(),isNaN(t)||this.error("expected word to be NaN"),t;switch("0"===this.ch&&(i+=this.ch,this.next(),"x"===this.ch||"X"===this.ch?(i+=this.ch,this.next(),r=16):this.ch>="0"&&this.ch<="9"&&this.error("Octal literal")),r){case 10:for(;this.ch>="0"&&this.ch<="9";)i+=this.ch,this.next();if("."===this.ch)for(i+=".";this.next()&&this.ch>="0"&&this.ch<="9";)i+=this.ch;if("e"===this.ch||"E"===this.ch)for(i+=this.ch,this.next(),("-"===this.ch||"+"===this.ch)&&(i+=this.ch,this.next());this.ch>="0"&&this.ch<="9";)i+=this.ch,this.next();break;case 16:for(;this.ch>="0"&&this.ch<="9"||this.ch>="A"&&this.ch<="F"||this.ch>="a"&&this.ch<="f";)i+=this.ch,this.next()}return t="-"===e?-i:+i,isFinite(t)?t:void this.error("Bad number")},t.prototype.string=function(){var e,i,r,o,s="";if('"'===this.ch||"'"===this.ch)for(r=this.ch;this.next();){if(this.ch===r)return this.next(),s;if("\\"===this.ch)if(this.next(),"u"===this.ch){for(o=0,i=0;4>i&&(e=parseInt(this.next(),16),isFinite(e));i+=1)o=16*o+e;s+=String.fromCharCode(o)}else if("\r"===this.ch)"\n"===this.peek()&&this.next();else{if("string"!=typeof t.escapee[this.ch])break;s+=t.escapee[this.ch]}else{if("\n"===this.ch)break;s+=this.ch}}this.error("Bad string")},t.prototype.inlineComment=function(){"/"!==this.ch&&this.error("Not an inline comment");do if(this.next(),"\n"===this.ch||"\r"===this.ch)return void this.next();while(this.ch)},t.prototype.blockComment=function(){"*"!==this.ch&&this.error("Not a block comment");do for(this.next();"*"===this.ch;)if(this.next("*"),"/"===this.ch)return void this.next("/");while(this.ch);this.error("Unterminated block comment")},t.prototype.comment=function(){"/"!==this.ch&&this.error("Not a comment"),this.next("/"),"/"===this.ch?this.inlineComment():"*"===this.ch?this.blockComment():this.error("Unrecognized comment")},t.prototype.white=function(){for(;this.ch;)if("/"===this.ch)this.comment();else{if(!(t.ws.indexOf(this.ch)>=0))return;this.next()}},t.prototype.word=function(){switch(this.ch){case"t":return this.next("t"),this.next("r"),this.next("u"),this.next("e"),!0;case"f":return this.next("f"),this.next("a"),this.next("l"),this.next("s"),this.next("e"),!1;case"n":return this.next("n"),this.next("u"),this.next("l"),this.next("l"),null;case"I":return this.next("I"),this.next("n"),this.next("f"),this.next("i"),this.next("n"),this.next("i"),this.next("t"),this.next("y"),1/0;case"N":return this.next("N"),this.next("a"),this.next("N"),0/0}this.error("Unexpected '"+this.ch+"'")},t.prototype.array=function(){var t=[];if("["===this.ch)for(this.next("["),this.white();this.ch;){if("]"===this.ch)return this.next("]"),t;if(","===this.ch?this.error("Missing array element"):t.push(this.value()),this.white(),","!==this.ch)return this.next("]"),t;this.next(","),this.white()}this.error("Bad array")},t.prototype.object=function(){var e,i,r=!0,o={};if(this.parseType>0&&(o[t.positionName]={start:this.at-1}),"{"===this.ch)for(this.next("{"),this.white(),i=this.at-1;this.ch;){if("}"===this.ch)return this.next("}"),o;if(e='"'===this.ch||"'"===this.ch?this.string():this.identifier(),this.white(),this.parseType>1&&(o[t.positionName][e]={start:i,valueStart:this.at}),this.next(":"),o[e]=this.value(),this.parseType>1&&(i=this.at-1,o[t.positionName][e].end=i),this.white(),","!==this.ch)return this.parseType>1&&o[t.positionName][e].end--,this.next("}"),this.parseType>0&&(o[t.positionName].end=this.at-1),o;this.parseType>1&&!r&&o[t.positionName][e].end--,this.next(","),this.white(),r=!1}this.error("Bad object")},t.prototype.value=function(){switch(this.white(),this.ch){case"{":return this.object();case"[":return this.array();case'"':case"'":return this.string();case"-":case"+":case".":return this.number();default:return this.ch>="0"&&this.ch<="9"?this.number():this.word()}},t.prototype.stringify=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),e&&"function"!=typeof e&&!this.isArray(e))throw new Error("Replacer must be a function or an array");this.replacer=e,this.indentStr=this.getIndent(i),this.objStack=[];var r={"":t};return void 0===t?this.getReplacedValueOrUndefined(r,"",!0):this.internalStringify(r,"",!0)},t.prototype.getIndent=function(t){if(t){if("string"==typeof t)return t;if("number"==typeof t&&t>=0)return this.makeIndent(" ",t,!0)}return""},t.prototype.getReplacedValueOrUndefined=function(t,e,i){var r=t[e];return r&&r.toJSON&&"function"==typeof r.toJSON&&(r=r.toJSON()),"function"==typeof this.replacer?this.replacer.call(t,e,r):this.replacer?i||this.isArray(t)||this.replacer.indexOf(e)>=0?r:void 0:r},t.prototype.isWordChar=function(t){return t>="a"&&"z">=t||t>="A"&&"Z">=t||t>="0"&&"9">=t||"_"===t||"$"===t},t.prototype.isWordStart=function(t){return t>="a"&&"z">=t||t>="A"&&"Z">=t||"_"===t||"$"===t},t.prototype.isWord=function(t){if("string"!=typeof t)return!1;if(!this.isWordStart(t[0]))return!1;for(var e=1,i=t.length;i>e;){if(!this.isWordChar(t[e]))return!1;e++}return!0},t.prototype.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},t.prototype.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},t.prototype.isNaN=function(t){return"number"==typeof t&&t!==t},t.prototype.checkForCircular=function(t){for(var e=0;e<this.objStack.length;e++)if(this.objStack[e]===t)throw new TypeError("Converting circular structure to JSON")},t.prototype.makeIndent=function(t,e,i){if(void 0===i&&(i=!1),!t)return"";t.length>10&&(t=t.substring(0,10));for(var r=i?"":"\n",o=0;e>o;o++)r+=t;return r},t.prototype.escapeString=function(e){return t.escapable.lastIndex=0,t.escapable.test(e)?'"'+e.replace(t.escapable,function(e){var i=t.meta[e];return"string"==typeof i?i:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},t.prototype.internalStringify=function(t,e,i){var r,o,s=this.getReplacedValueOrUndefined(t,e,i);switch(s&&!this.isDate(s)&&(s=s.valueOf()),typeof s){case"boolean":return s.toString();case"number":return isNaN(s)||!isFinite(s)?"null":s.toString();case"string":return this.escapeString(s.toString());case"object":if(null===s)return"null";if(this.isArray(s)){this.checkForCircular(s),r="[",this.objStack.push(s);for(var n=0;n<s.length;n++)o=this.internalStringify(s,n,!1),r+=this.makeIndent(this.indentStr,this.objStack.length),r+=null===o||"undefined"==typeof o?"null":o,n<s.length-1?r+=",":this.indentStr&&(r+="\n");this.objStack.pop(),r+=this.makeIndent(this.indentStr,this.objStack.length,!0)+"]"}else{this.checkForCircular(s),r="{";var a=!1;this.objStack.push(s);for(var h in s)if(s.hasOwnProperty(h)){var u=this.internalStringify(s,h,!1);if(i=!1,"undefined"!=typeof u&&null!==u){r+=this.makeIndent(this.indentStr,this.objStack.length),a=!0;var e=this.isWord(h)?h:this.escapeString(h);r+=e+":"+(this.indentStr?" ":"")+u+","}}this.objStack.pop(),r=a?r.substring(0,r.length-1)+this.makeIndent(this.indentStr,this.objStack.length)+"}":"{}"}return r;default:return void 0}},t.positionName="pos",t.escapee={"'":"'",'"':'"',"\\":"\\","/":"/","\n":"",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},t.ws=[" ","	","\r","\n","","\f"," ","\ufeff"],t.cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,t.escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,t.meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t}();t.SurveyJSON5=e}(SurveyEditor||(SurveyEditor={}));var templateEditor;!function(t){var e;!function(t){t.html='<script type="text/html" id="objecteditor">    <div  data-bind="visible:koHasObject" style="margin:10px;width:100%">        <div style="background-color:lightgray">            <a href="#" data-bind="click: showProperties">                <span data-bind="text: koShowProperties() ? \'Hide\': \'Show\'"></span>            </a>            <span data-bind="text: koTitle"></span>        </div>        <div>            <table data-bind="visible:koShowProperties">                <tbody data-bind="foreach: koProperties">                    <tr data-bind="click: $parent.changeActiveProperty($data), style: {background: $parent.koActiveProperty() == $data ? \'lightgray\': \'\'}">                        <td data-bind="text: name"></td>                        <td>                            <span data-bind="text: koText, visible: $parent.koActiveProperty() != $data, attr: {title: koText}, style: {color: koIsDefault() ? \'gray\' : \'\'}" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden"></span>                            <!-- ko if: editorType == \'text\' -->                            <input type="text" data-bind="value: koValue, visible: $parent.koActiveProperty() == $data" />                            <!-- /ko -->                            <!-- ko if: editorType == \'boolean\' -->                            <input type="checkbox" data-bind="checked: koValue, visible: $parent.koActiveProperty() == $data" />                            <!-- /ko -->                            <!-- ko if: editorType == \'dropdown\' -->                            <select data-bind="value: koValue, visible: $parent.koActiveProperty() == $data, options: choices"></select>                            <!-- /ko -->                            <!-- ko if: editorType == \'itemvalues\' -->                            <div data-bind="visible: $parent.koActiveProperty() == $data, with: itemValues" style="position:absolute; z-index:100; top:parentOffset.top;left:parentOffset.left - 100;background-color:lightgray">                                <table>                                    <thead>                                        <tr>                                            <th>Value</th>                                            <th>Text</th>                                            <th></th>                                        </tr>                                    </thead>                                    <tbody>                                        <!-- ko foreach: koItems -->                                        <tr>                                            <td><input type="text" data-bind="value:koValue" style="width:100px" /></td>                                            <td><input type="text" data-bind="value:koText" style="width:100px" /></td>                                            <td><input type="button" data-bind="click: $parent.onDeleteClick" value="Delete" /></td>                                        </tr>                                        <!-- /ko -->                                        <tr>                                            <td><input type="text" data-bind="value:koNewValue" style="width:100px" /></td>                                            <td><input type="text" data-bind="value:koNewText" style="width:100px" /></td>                                            <td><input type="button" data-bind="click: onAddClick" value="Add" /></td>                                        </tr>                                    </tbody>                                </table>                                <input type="button" value="Apply" data-bind="click: onApplyClick" />                            </div>                            <!-- /ko -->                        </td>                    </tr>                </tbody>            </table>        </div>    </div></script><script type="text/html" id="pageeditor">    <div data-bind="visible:koIsValid">        <!-- ko foreach: koPages -->            <div data-bind="text: title, style: {background: koSelected() ? \'darkgray\' : \'lightgray\'},click:$parent.selectPageClick" style="padding:2px;display:table-cell;white-space:nowrap;cursor:pointer"></div>        <!-- /ko  -->        <div style="display:table-cell;padding:2px">            <input type="button" data-bind="click:addNewPageClick" value="Add New Page" />        </div>    </div></script><div style="overflow:hidden;position:relative;display:table">    <div id="surveyjsPanel" style="display:table-cell;vertical-align:top">        <div style="width:300px;height:400px;overflow-y:auto;overflow-x:hidden">            <div data-bind="template: { name: \'objecteditor\', data: surveyEditor }"></div>            <div data-bind="visible: koSelectedPage() != null">                <div data-bind="template: { name: \'objecteditor\', data: pageEditor }"></div>                <div data-bind="template: { name: \'objecteditor\', data: questionEditor }"></div>            </div>        </div>        <div  data-bind="visible: koSelectedPage() != null">            <select data-bind="options: questionTypes, value: koSelectedQuestionType"></select>            <input type="button" value="Add Question" data-bind="click: addQuestion" />        </div>    </div>    <div style="display:table-cell;width:100%">        <div id="surveyjsEditor" style="height:400px;width:100%">        </div>        <div data-bind="template: { name: \'pageeditor\', data: pagesEditor }" style="width:20px"></div>    </div></div><div id="surveyjsExample" style="height:400px;width:100%"></div>'}(e=t.ko||(t.ko={}))}(templateEditor||(templateEditor={}));